# ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‰Šé™¤æ©Ÿèƒ½ - ä»•æ§˜æ›¸

> Message Delete Function - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‰Šé™¤æ©Ÿèƒ½

æœ€çµ‚æ›´æ–°: 2026å¹´2æœˆ27æ—¥ï¼ˆå®Ÿè¡Œç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒ»è¨­å®šå¤‰æ›´ã‚³ãƒãƒ³ãƒ‰è¿½åŠ ï¼‰

---

## ğŸ“‹ æ¦‚è¦

### ç›®çš„

ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚¿ãƒ¼æ¨©é™ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€ã‚µãƒ¼ãƒãƒ¼å†…ã®å…¨ãƒãƒ£ãƒ³ãƒãƒ«ã¾ãŸã¯ç‰¹å®šãƒãƒ£ãƒ³ãƒãƒ«ã«ã‚ãŸã£ã¦ã€ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ä¸€è‡´ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ»æŒ‡å®šä»¶æ•°ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¸€æ‹¬å‰Šé™¤ã§ãã‚‹æ©Ÿèƒ½ã‚’æä¾›ã—ã€ã‚¹ãƒ‘ãƒ ã‚„ä¸é©åˆ‡ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¿…é€Ÿãªå¯¾å¿œã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚

### ä¸»ãªç”¨é€”

1. **ã‚¹ãƒ‘ãƒ å¯¾ç­–**: ã‚µãƒ¼ãƒãƒ¼å…¨ä½“ã«æ¸¡ã‚‹ã‚¹ãƒ‘ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æ¨ªæ–­çš„ã«ä¸€æ‹¬å‰Šé™¤
2. **ä¸é©åˆ‡ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å‰Šé™¤**: ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ã®é•åãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚µãƒ¼ãƒãƒ¼å…¨ä½“ã‹ã‚‰ä¸€æ‹¬å‰Šé™¤
3. **ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å‰Šé™¤**: ç‰¹å®šã®è¨€è‘‰ãƒ»ãƒ•ãƒ¬ãƒ¼ã‚ºã‚’å«ã‚€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚µãƒ¼ãƒãƒ¼å…¨ä½“ã‹ã‚‰å‰Šé™¤
4. **ãƒãƒ£ãƒ³ãƒãƒ«ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—**: ãƒ†ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚„å¤ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ•´ç†
5. **ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹ç‡åŒ–**: æ‰‹å‹•å‰Šé™¤ã®æ‰‹é–“ã‚’å¤§å¹…ã«å‰Šæ¸›

### ç‰¹å¾´

- **ã‚µãƒ¼ãƒãƒ¼å…¨ãƒãƒ£ãƒ³ãƒãƒ«å¯¾å¿œ**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã‚µãƒ¼ãƒãƒ¼å†…ã®å…¨ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒ³ãƒãƒ«ã‚’æ¨ªæ–­ã—ã¦å‰Šé™¤
- **æŸ”è»Ÿãªå‰Šé™¤æ¡ä»¶**: ä»¶æ•°ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒ»æœŸé–“ï¼ˆæ—¥æ•°/æ—¥ä»˜ç¯„å›²ï¼‰ãƒ»ãƒãƒ£ãƒ³ãƒãƒ«ã‚’è‡ªç”±ã«çµ„ã¿åˆã‚ã›
- **æœŸé–“æŒ‡å®šå‰Šé™¤**: éå»Næ—¥ä»¥å†…ï¼ˆ`days`ï¼‰ã‚„ç‰¹å®šã®æ—¥ä»˜ç¯„å›²ï¼ˆ`after` / `before`ï¼‰ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’çµã‚Šè¾¼ã‚“ã§å‰Šé™¤
- **14æ—¥ä»¥ä¸Šå‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«ã‚‚å¯¾å¿œ**: å¤ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚‚å€‹åˆ¥å‰Šé™¤ã§å¯¾å¿œ
- **å®‰å…¨æ€§é‡è¦–**: ãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶ï¼ˆ`count`ãƒ»`user`ãƒ»`keyword`ãƒ»`days`ãƒ»`after`ãƒ»`before`ï¼‰ã®ã„ãšã‚Œã‚‚æœªæŒ‡å®šæ™‚ã¯å®Ÿè¡Œã‚’æ‹’å¦
- **é€²æ—è¡¨ç¤º**: å¤§é‡å‰Šé™¤æ™‚ã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§é€²æ—ã‚’è¡¨ç¤º
- **Cooldownæ©Ÿèƒ½**: é€£ç¶šå®Ÿè¡Œã‚’é˜²æ­¢ã—ã€èª¤æ“ä½œã‚’è»½æ¸›
- **å®Ÿè¡Œç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°**: å‰Šé™¤å®Ÿè¡Œå‰ã«ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤ºã€‚èª¤æ“ä½œã‚’é˜²æ­¢ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«ã€Œæ¬¡å›ã‹ã‚‰ç¢ºèªã—ãªã„ã€è¨­å®šãŒå¯èƒ½ï¼‰
- **å‰Šé™¤çµæœã®è©³ç´°è¡¨ç¤º**: å‰Šé™¤å®Œäº†å¾Œã«å‰Šé™¤ä»¶æ•°ãƒ»å‰Šé™¤ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å†…å®¹ï¼ˆæŠ•ç¨¿è€…/æ—¥ä»˜/æœ¬æ–‡ï¼‰ã‚’ãƒšãƒ¼ã‚¸ãƒã‚¤ã‚·ãƒ§ãƒ³ä»˜ãã§è¡¨ç¤º
- **çµæœãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½**: å‰Šé™¤çµæœã‚’æŠ•ç¨¿è€…ãƒ»ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹ãƒ»æ—¥ä»˜ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã¦ç¢ºèªå¯èƒ½

---

## ğŸ¯ ä¸»è¦æ©Ÿèƒ½

### `/message-delete` ã‚³ãƒãƒ³ãƒ‰

ãƒãƒ£ãƒ³ãƒãƒ«å†…ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¸€æ‹¬å‰Šé™¤

### `/message-delete-config` ã‚³ãƒãƒ³ãƒ‰

`/message-delete` ã®æŒ™å‹•è¨­å®šã‚’å¤‰æ›´ã™ã‚‹ã€‚ç¾æ™‚ç‚¹ã§ã¯å®Ÿè¡Œç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®æœ‰åŠ¹/ç„¡åŠ¹ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã€‚è¨­å®šã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã« DB ã«æ°¸ç¶šä¿å­˜ã•ã‚Œã‚‹ã€‚

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | å‹      | èª¬æ˜                                                                    |
| ---------- | ------- | ----------------------------------------------------------------------- |
| `confirm`  | Boolean | `true`ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰: å‰Šé™¤å‰ã«ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤ºã€‚`false`: ã‚¹ã‚­ãƒƒãƒ—ã€‚ |

---

## âš™ï¸ ã‚³ãƒãƒ³ãƒ‰ä»•æ§˜

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³

**1. `count` (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)**

- å‰Šé™¤ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°
- ç¯„å›²: 1ä»¥ä¸Šï¼ˆä¸Šé™ãªã—ï¼‰
- æœªæŒ‡å®šã®å ´åˆ: å¯¾è±¡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã™ã¹ã¦å‰Šé™¤
- æ³¨: å¤§é‡å‰Šé™¤ã¯æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™

**2. `user` (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)**

- å‰Šé™¤å¯¾è±¡ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æŒ‡å®š
- æŒ‡å®šã—ãŸå ´åˆã€ãã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿å‰Šé™¤
- æœªæŒ‡å®šã®å ´åˆã€ã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå¯¾è±¡

**3. `keyword` (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)**

- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æœ¬æ–‡ã«å¯¾ã—ã¦éƒ¨åˆ†ä¸€è‡´æ¤œç´¢ã‚’è¡Œã„ã€ãƒãƒƒãƒã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿ã‚’å‰Šé™¤å¯¾è±¡ã¨ã™ã‚‹
- å¤§æ–‡å­—/å°æ–‡å­—ã‚’åŒºåˆ¥ã—ãªã„ï¼ˆcase-insensitiveï¼‰
- `user` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨ä½µç”¨å¯ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ AND ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®ä¸¡æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤ï¼‰
- æœªæŒ‡å®šã®å ´åˆã€ãƒ†ã‚­ã‚¹ãƒˆå†…å®¹ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã¯è¡Œã‚ãªã„

**4. `days` (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)**

- éå»Næ—¥ä»¥å†…ã«æŠ•ç¨¿ã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿ã‚’å‰Šé™¤å¯¾è±¡ã¨ã™ã‚‹
- ç¯„å›²: 1ä»¥ä¸Š
- ä¾‹: `days:7` â†’ éå»7æ—¥ä»¥å†…ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿å‰Šé™¤
- `after` / `before` ã¨ã®åŒæ™‚æŒ‡å®šä¸å¯ï¼ˆæ’ä»–ï¼‰
- `count` ã¨çµ„ã¿åˆã‚ã›å¯ï¼ˆæœŸé–“å†…ã§ã•ã‚‰ã«ä»¶æ•°ã‚’çµã‚‹ï¼‰

**5. `after` (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)**

- ã“ã®æ—¥æ™‚ä»¥é™ã«æŠ•ç¨¿ã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿ã‚’å‰Šé™¤å¯¾è±¡ã¨ã™ã‚‹
- å½¢å¼: `YYYY-MM-DD` ã¾ãŸã¯ `YYYY-MM-DDTHH:MM:SS`ï¼ˆISO 8601 ç›¸å½“ã€æ™‚åˆ»çœç•¥æ™‚ã¯ `00:00:00` æ‰±ã„ï¼‰
- ä¾‹: `after:2026-01-01` â†’ 2026å¹´1æœˆ1æ—¥ä»¥é™ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿å‰Šé™¤
- `days` ã¨ã®åŒæ™‚æŒ‡å®šä¸å¯ï¼ˆæ’ä»–ï¼‰
- `before` ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§æ—¥ä»˜ç¯„å›²ã‚’æŒ‡å®šå¯èƒ½

**6. `before` (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)**

- ã“ã®æ—¥æ™‚ä»¥å‰ã«æŠ•ç¨¿ã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿ã‚’å‰Šé™¤å¯¾è±¡ã¨ã™ã‚‹
- å½¢å¼: `YYYY-MM-DD` ã¾ãŸã¯ `YYYY-MM-DDTHH:MM:SS`ï¼ˆISO 8601 ç›¸å½“ã€æ™‚åˆ»çœç•¥æ™‚ã¯ `23:59:59` æ‰±ã„ï¼‰
- ä¾‹: `before:2026-02-01` â†’ 2026å¹´2æœˆ1æ—¥ä»¥å‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿å‰Šé™¤
- `days` ã¨ã®åŒæ™‚æŒ‡å®šä¸å¯ï¼ˆæ’ä»–ï¼‰
- `after` ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§æ—¥ä»˜ç¯„å›²ã‚’æŒ‡å®šå¯èƒ½

**7. `channel` (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)**

- å‰Šé™¤å¯¾è±¡ã‚’çµã‚Šè¾¼ã‚€ãƒãƒ£ãƒ³ãƒãƒ«ã‚’æŒ‡å®š
- **æœªæŒ‡å®šã®å ´åˆã€ã‚µãƒ¼ãƒãƒ¼å†…ã®å…¨ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒ³ãƒãƒ«ã‚’å¯¾è±¡** ã¨ã™ã‚‹ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: ã‚µãƒ¼ãƒãƒ¼å…¨ä½“ï¼‰
- ãƒ†ã‚­ã‚¹ãƒˆãƒ™ãƒ¼ã‚¹ã®ãƒãƒ£ãƒ³ãƒãƒ«ï¼ˆTextChannel, NewsChannel ç­‰ï¼‰ã®ã¿å¯¾è±¡
- BotãŒã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’æŒãŸãªã„ãƒãƒ£ãƒ³ãƒãƒ«ã¯ã‚¹ã‚­ãƒƒãƒ—

### ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

- ä»¥ä¸‹ã®ã€Œãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€ã®ã„ãšã‚Œã‚‚æœªæŒ‡å®šã®å ´åˆã¯å®Ÿè¡Œã‚’æ‹’å¦ã™ã‚‹ï¼š
  - `count`ãƒ»`user`ãƒ»`keyword`ãƒ»`days`ãƒ»`after`ãƒ»`before`
  - `channel` ã®ã¿æŒ‡å®šã§ã‚‚æ‹’å¦ï¼ˆãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶ãªã—ã§ãƒãƒ£ãƒ³ãƒãƒ«å…¨å‰Šé™¤ã«ãªã‚‹ãŸã‚ï¼‰
- `days` ã¨ `after` / `before` ã‚’åŒæ™‚æŒ‡å®šã—ãŸå ´åˆã¯ã‚¨ãƒ©ãƒ¼ï¼ˆæ’ä»–ï¼‰
- `after` > `before`ï¼ˆé–‹å§‹ãŒçµ‚äº†ã‚ˆã‚Šå¾Œï¼‰ã®å ´åˆã¯ã‚¨ãƒ©ãƒ¼
- `after` / `before` ã«ç„¡åŠ¹ãªæ—¥ä»˜å½¢å¼ã‚’æŒ‡å®šã—ãŸå ´åˆã¯ã‚¨ãƒ©ãƒ¼

---

## âš ï¸ å®Ÿè¡Œç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°

### æ¦‚è¦

`/message-delete-config confirm:true`ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¯¾ã—ã¦ã€ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³æ¤œè¨¼ãƒ»æ¨©é™ãƒã‚§ãƒƒã‚¯é€šéå¾Œï¼‰ã«ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’ Ephemeral ã§è¡¨ç¤ºã™ã‚‹ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ‰¿èªã™ã‚‹ã¾ã§å‰Šé™¤å‡¦ç†ã¯é–‹å§‹ã—ãªã„ã€‚

### ãƒ€ã‚¤ã‚¢ãƒ­ã‚° UI

```
âš ï¸ **ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“**

ä»¥ä¸‹ã®æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤ã—ã¾ã™ã€‚å®Ÿè¡Œã—ã¾ã™ã‹ï¼Ÿ

å¯¾è±¡ãƒãƒ£ãƒ³ãƒãƒ«: ã‚µãƒ¼ãƒãƒ¼å…¨ä½“
å‰Šé™¤æ¡ä»¶:
  ãƒ¦ãƒ¼ã‚¶ãƒ¼    : @BadUser
  ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰  : "ã‚¹ãƒ‘ãƒ "
  æœŸé–“        : éå»7æ—¥é–“

[âœ… å‰Šé™¤ã™ã‚‹]  [âŒ ã‚­ãƒ£ãƒ³ã‚»ãƒ«]  [[ ] æ¬¡å›ã‹ã‚‰ç¢ºèªã—ãªã„]
```

#### ãƒœã‚¿ãƒ³ä»•æ§˜

| ãƒœã‚¿ãƒ³             | customId                     | ã‚¹ã‚¿ã‚¤ãƒ«                               | å‹•ä½œ                                                                                   |
| ------------------ | ---------------------------- | -------------------------------------- | -------------------------------------------------------------------------------------- |
| âœ… å‰Šé™¤ã™ã‚‹        | `msgdel_confirm_yes`         | `ButtonStyle.Danger`ï¼ˆèµ¤ï¼‰             | å‰Šé™¤å‡¦ç†ã‚’é–‹å§‹ã™ã‚‹ã€‚`skipConfirm` ãƒ•ãƒ©ã‚°ãŒç«‹ã£ã¦ã„ã‚‹å ´åˆã¯è¨­å®šã‚’ DB ã«ä¿å­˜ã—ã¦ã‹ã‚‰å®Ÿè¡Œ |
| âŒ ã‚­ãƒ£ãƒ³ã‚»ãƒ«      | `msgdel_confirm_no`          | `ButtonStyle.Secondary`ï¼ˆã‚°ãƒ¬ãƒ¼ï¼‰      | ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‰ã˜ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã€‚å‰Šé™¤ã¯å®Ÿè¡Œã—ãªã„                           |
| æ¬¡å›ã‹ã‚‰ç¢ºèªã—ãªã„ | `msgdel_confirm_skip_toggle` | OFF: `Secondary` / ON: `Success`ï¼ˆç·‘ï¼‰ | ON/OFF ã®ãƒˆã‚°ãƒ«ã€‚çŠ¶æ…‹ã¯ã€Œå‰Šé™¤ã™ã‚‹ã€æŠ¼ä¸‹æ™‚ã« DB ã¸ä¿å­˜ï¼ˆå˜ç‹¬ã§ã¯ä¿å­˜ã—ãªã„ï¼‰            |

#### ã€Œæ¬¡å›ã‹ã‚‰ç¢ºèªã—ãªã„ã€ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹é·ç§»

- åˆæœŸçŠ¶æ…‹ï¼ˆOFFï¼‰: `[ ] æ¬¡å›ã‹ã‚‰ç¢ºèªã—ãªã„`ï¼ˆ`ButtonStyle.Secondary`ï¼‰
- æŠ¼ä¸‹å¾Œï¼ˆONï¼‰: `[âœ“] æ¬¡å›ã‹ã‚‰ç¢ºèªã—ãªã„`ï¼ˆ`ButtonStyle.Success` ã«å¤‰åŒ–ï¼‰
- å†åº¦æŠ¼ä¸‹: åˆæœŸçŠ¶æ…‹ã«æˆ»ã‚‹ï¼ˆãƒˆã‚°ãƒ«ï¼‰
- ã€Œâœ… å‰Šé™¤ã™ã‚‹ã€æŠ¼ä¸‹æ™‚ã«ã€ç¾åœ¨ã®ãƒˆã‚°ãƒ«çŠ¶æ…‹ã‚’ `skipConfirm` ã¨ã—ã¦ DB ã«ä¿å­˜ã™ã‚‹

### ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤ºæ¡ä»¶

| æ¡ä»¶                                                                   | ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º |
| ---------------------------------------------------------------------- | -------------- |
| `confirm = true`ï¼ˆDB æœªç™»éŒ²ï¼ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå«ã‚€ï¼‰                          | è¡¨ç¤º           |
| `confirm = false`ï¼ˆ`/message-delete-config confirm:false` ã§è¨­å®šæ¸ˆã¿ï¼‰ | ã‚¹ã‚­ãƒƒãƒ—       |

### ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: **60ç§’**
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå¾Œã¯ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–ã—ã€`âŒ› ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸã€‚å†åº¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚` ã¨è¡¨ç¤º
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã¯ã‚­ãƒ£ãƒ³ã‚»ãƒ«æ‰±ã„ï¼ˆå‰Šé™¤ã¯å®Ÿè¡Œã—ãªã„ï¼‰

### `/message-delete-config` ã‚³ãƒãƒ³ãƒ‰ã®è¨­å®šåæ˜ 

```
/message-delete-config confirm:false
â†’ æ¬¡å›ä»¥é™ã® /message-delete å®Ÿè¡Œã§ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’ã‚¹ã‚­ãƒƒãƒ—

/message-delete-config confirm:true
â†’ ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’å†åº¦æœ‰åŠ¹åŒ–
```

- å¤‰æ›´å¾Œã¯ `âœ… è¨­å®šã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚æ¬¡å›ã® /message-delete ã‹ã‚‰åæ˜ ã•ã‚Œã¾ã™ã€‚` ã¨ Ephemeral ã§å¿œç­”

### è¨­å®šã®æ°¸ç¶šåŒ–

- ä¿å­˜å…ˆ: DB ã® `user_settings` ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆã¾ãŸã¯åŒç­‰ã®ã‚­ãƒ¼ãƒãƒªãƒ¥ãƒ¼ã‚¹ãƒˆã‚¢ï¼‰
- ã‚­ãƒ¼: `userId + guildId`ï¼ˆã‚®ãƒ«ãƒ‰ã”ã¨ã«ç‹¬ç«‹ï¼‰
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: `skipConfirm = false`ï¼ˆç¢ºèªã‚ã‚Šï¼‰
- ã€Œæ¬¡å›ã‹ã‚‰ç¢ºèªã—ãªã„ã€ãƒˆã‚°ãƒ« ON ã§ã€Œå‰Šé™¤ã™ã‚‹ã€ã‚’æŠ¼ã—ãŸå ´åˆã¨ã€`/message-delete-config confirm:false` ã®ä¸¡æ–¹ã§ `skipConfirm = true` ã«æ›´æ–°ã•ã‚Œã‚‹

---

## ğŸ’¡ ä½¿ç”¨ä¾‹

### âš ï¸ æ³¨æ„: ãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å…¨æœªæŒ‡å®šã¯ç¦æ­¢

```
/message-delete
```

- **ã‚¨ãƒ©ãƒ¼**: ãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶ï¼ˆ`count`ãƒ»`user`ãƒ»`keyword`ãƒ»`days`ãƒ»`after`ãƒ»`before`ï¼‰ãŒã™ã¹ã¦æœªæŒ‡å®šã®å ´åˆã¯è­¦å‘Šã‚’è¡¨ç¤ºã—ã¦ä¸­æ­¢

```
/message-delete channel:#general
```

- **ã‚¨ãƒ©ãƒ¼**: `channel` ã®ã¿æŒ‡å®šã‚‚ç¦æ­¢ï¼ˆãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶ãªã—ã§ãƒãƒ£ãƒ³ãƒãƒ«å…¨å‰Šé™¤ã«ãªã‚‹ãŸã‚ï¼‰

```
/message-delete days:7 after:2026-01-01
```

- **ã‚¨ãƒ©ãƒ¼**: `days` ã¨ `after` / `before` ã®åŒæ™‚æŒ‡å®šã¯ä¸å¯

```
/message-delete after:2026-02-28 before:2026-01-01
```

- **ã‚¨ãƒ©ãƒ¼**: `after` ãŒ `before` ã‚ˆã‚Šå¾Œã®æ—¥æ™‚ã¯ä¸å¯

### ä¾‹1: ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚µãƒ¼ãƒãƒ¼å…¨ä½“ã‹ã‚‰å‰Šé™¤

```
/message-delete user:@BadUser
```

- ã‚µãƒ¼ãƒãƒ¼å†…ã®**å…¨ãƒãƒ£ãƒ³ãƒãƒ«**ã‹ã‚‰ `@BadUser` ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã™ã¹ã¦æ¤œç´¢ã—ã¦å‰Šé™¤
- ãƒãƒ£ãƒ³ãƒãƒ«ã”ã¨ã«é †æ¬¡å‡¦ç†ã—ã€é€²æ—ã‚’è¡¨ç¤º

### ä¾‹2: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚µãƒ¼ãƒãƒ¼å…¨ä½“ã‹ã‚‰å‰Šé™¤

```
/message-delete keyword:ã‚¹ãƒ‘ãƒ 
```

- ã‚µãƒ¼ãƒãƒ¼å†…ã®**å…¨ãƒãƒ£ãƒ³ãƒãƒ«**ã‹ã‚‰ã€Œã‚¹ãƒ‘ãƒ ã€ã‚’å«ã‚€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã™ã¹ã¦å‰Šé™¤

### ä¾‹3: ãƒ¦ãƒ¼ã‚¶ãƒ¼ + ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®çµ„ã¿åˆã‚ã›ã§å‰Šé™¤

```
/message-delete user:@BadUser keyword:å®£ä¼
```

- ã‚µãƒ¼ãƒãƒ¼å†…ã®å…¨ãƒãƒ£ãƒ³ãƒãƒ«ã‹ã‚‰ `@BadUser` ãŒæŠ•ç¨¿ã—ãŸã€Œå®£ä¼ã€ã‚’å«ã‚€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤

### ä¾‹4: ä»¶æ•°ã‚’æŒ‡å®šã—ã¦ã‚µãƒ¼ãƒãƒ¼å…¨ä½“ã‹ã‚‰å‰Šé™¤

```
/message-delete count:100 user:@Spammer
```

- ã‚µãƒ¼ãƒãƒ¼å…¨ä½“ã‹ã‚‰ `@Spammer` ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æœ€å¤§100ä»¶å‰Šé™¤
- ä»¶æ•°ã¯å…¨ãƒãƒ£ãƒ³ãƒãƒ«ã®åˆè¨ˆï¼ˆä¾‹: ãƒãƒ£ãƒ³ãƒãƒ«Aã§60ä»¶ã€ãƒãƒ£ãƒ³ãƒãƒ«Bã§40ä»¶ï¼‰

### ä¾‹5: ç‰¹å®šãƒãƒ£ãƒ³ãƒãƒ«ã«çµã£ã¦å‰Šé™¤

```
/message-delete keyword:åºƒå‘Š channel:#general
```

- `#general` ãƒãƒ£ãƒ³ãƒãƒ«ã®ã¿ã§ã€Œåºƒå‘Šã€ã‚’å«ã‚€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤

### ä¾‹6: å¤ã„ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤

```
/message-delete count:5 user:@User channel:#profile
```

- `#profile` ãƒãƒ£ãƒ³ãƒãƒ«ã® `@User` ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’5ä»¶å‰Šé™¤
- 3ãƒ¶æœˆå‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã‚‚å‰Šé™¤å¯èƒ½ï¼ˆå€‹åˆ¥å‰Šé™¤ã§å¯¾å¿œï¼‰

### ä¾‹7: å¤§é‡å‰Šé™¤ï¼ˆã‚µãƒ¼ãƒãƒ¼å…¨ä½“ + ä»¶æ•°ä¸Šé™ã‚ã‚Šï¼‰

```
/message-delete count:500 keyword:NGãƒ¯ãƒ¼ãƒ‰
```

- ã‚µãƒ¼ãƒãƒ¼å…¨ä½“ã‹ã‚‰ã€ŒNGãƒ¯ãƒ¼ãƒ‰ã€ã‚’å«ã‚€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æœ€å¤§500ä»¶å‰Šé™¤
- 100ä»¶ãšã¤è¤‡æ•°å›ã«åˆ†ã‘ã¦å‰Šé™¤å‡¦ç†ã‚’å®Ÿè¡Œ

### ä¾‹8: éå»7æ—¥ä»¥å†…ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤ï¼ˆæ—¥æ•°æŒ‡å®šï¼‰

```
/message-delete days:7 user:@Spammer
```

- ã‚µãƒ¼ãƒãƒ¼å…¨ä½“ã‹ã‚‰ `@Spammer` ã®éå»7æ—¥ä»¥å†…ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã™ã¹ã¦å‰Šé™¤

### ä¾‹9: ç‰¹å®šæ—¥ä»¥é™ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤ï¼ˆafter æŒ‡å®šï¼‰

```
/message-delete after:2026-02-01 keyword:å®£ä¼
```

- 2026å¹´2æœˆ1æ—¥ä»¥é™ã«æŠ•ç¨¿ã•ã‚ŒãŸã€Œå®£ä¼ã€ã‚’å«ã‚€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚µãƒ¼ãƒãƒ¼å…¨ä½“ã‹ã‚‰å‰Šé™¤

### ä¾‹10: æ—¥ä»˜ç¯„å›²ã‚’æŒ‡å®šã—ã¦å‰Šé™¤ï¼ˆafter + beforeï¼‰

```
/message-delete after:2026-01-01 before:2026-01-31 user:@BadUser
```

- 2026å¹´1æœˆ1æ—¥ã€œ1æœˆ31æ—¥ã®é–“ã« `@BadUser` ãŒæŠ•ç¨¿ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚µãƒ¼ãƒãƒ¼å…¨ä½“ã‹ã‚‰å‰Šé™¤

### ä¾‹11: æœŸé–“ + ãƒãƒ£ãƒ³ãƒãƒ«çµã‚Šè¾¼ã¿

```
/message-delete days:3 channel:#general
```

- `#general` ãƒãƒ£ãƒ³ãƒãƒ«ã®éå»3æ—¥ä»¥å†…ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã™ã¹ã¦å‰Šé™¤

### ä¾‹12: ä»¶æ•°ä¸Šé™ + æ—¥ä»˜ç¯„å›²

```
/message-delete count:200 after:2026-02-20T00:00:00 before:2026-02-27T23:59:59
```

- æŒ‡å®šæœŸé–“å†…ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æœ€å¤§200ä»¶å‰Šé™¤ï¼ˆæ™‚åˆ»ã¾ã§æŒ‡å®šã™ã‚‹ä¾‹ï¼‰

---

## ğŸ”’ æ¨©é™ãƒã‚§ãƒƒã‚¯

### å®Ÿè¡Œè€…ã®å¿…è¦æ¨©é™

- `MANAGE_MESSAGES` (ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç®¡ç†)
- ã¾ãŸã¯ã€`ADMINISTRATOR` (ç®¡ç†è€…)

### Botã®å¿…è¦æ¨©é™

- `MANAGE_MESSAGES` (ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç®¡ç†)
- `READ_MESSAGE_HISTORY` (ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å±¥æ­´ã®é–²è¦§)
- `VIEW_CHANNEL` (ãƒãƒ£ãƒ³ãƒãƒ«ã®é–²è¦§ â€»å…¨ãƒãƒ£ãƒ³ãƒãƒ«æ¨ªæ–­å‰Šé™¤æ™‚)

**æ¨©é™ä¸è¶³ã®å ´åˆ:**

- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
- ãƒ­ã‚°ã«è¨˜éŒ²

### Cooldownï¼ˆã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ï¼‰

- **å¾…æ©Ÿæ™‚é–“**: 5ç§’
- **ç›®çš„**: åŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã‚‹é€£ç¶šå®Ÿè¡Œã‚’é˜²æ­¢
- **æ³¨æ„**: å¤§é‡å‰Šé™¤ä¸­ã¯å‡¦ç†ãŒå®Œäº†ã™ã‚‹ã¾ã§æ™‚é–“ãŒã‹ã‹ã‚‹ãŸã‚ã€å®Œäº†å‰ã«å†å®Ÿè¡Œã—ã¦ã‚‚ cooldown ã§åˆ¶é™ã•ã‚Œã‚‹

### åŒæ™‚å®Ÿè¡Œæ™‚ã®æŒ™å‹•

**åŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé€£ç¶šå®Ÿè¡Œ:**

- Cooldown (5ç§’) ã«ã‚ˆã‚Šåˆ¶é™ã•ã‚Œã‚‹
- å‰å›ã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã‹ã‚‰5ç§’çµŒéã—ã¦ã„ãªã„ã¨å®Ÿè¡Œã§ããªã„

**ç•°ãªã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåŒã˜ãƒãƒ£ãƒ³ãƒãƒ«ã§å®Ÿè¡Œ:**

- åŒæ™‚å®Ÿè¡Œå¯èƒ½ï¼ˆåˆ¶é™ãªã—ï¼‰
- ä¸¡æ–¹ã®å‰Šé™¤å‡¦ç†ãŒä¸¦è¡Œã—ã¦å®Ÿè¡Œã•ã‚Œã‚‹
- æ³¨æ„ç‚¹:
  - åŒã˜ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§
  - ã‚¨ãƒ©ãƒ¼ã¯ç„¡è¦–ã—ã¦å‡¦ç†ã‚’ç¶™ç¶šï¼ˆå¾Œè¿°ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å‚ç…§ï¼‰
  - ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã«å¼•ã£ã‹ã‹ã‚Šã‚„ã™ããªã‚‹

**æ¨å¥¨äº‹é …:**

- åŒã˜ãƒãƒ£ãƒ³ãƒãƒ«ã§è¤‡æ•°ã®ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚¿ãƒ¼ãŒåŒæ™‚ã«å‰Šé™¤ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãªã„ã‚ˆã†ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å–ã‚‹
- å¤§é‡å‰Šé™¤ä¸­ã¯ä»–ã®ãƒ¢ãƒ‡ãƒ¬ãƒ¼ã‚¿ãƒ¼ã«é€šçŸ¥ã™ã‚‹

---

## ğŸ”„ å‡¦ç†ãƒ•ãƒ­ãƒ¼

```
1. ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
   â†“
2. ã‚ªãƒ—ã‚·ãƒ§ãƒ³æ¤œè¨¼
   - countãƒ»userãƒ»keywordãƒ»daysãƒ»afterãƒ»before ãŒã™ã¹ã¦æœªæŒ‡å®šã®å ´åˆã¯è­¦å‘Šã‚’å‡ºã—ã¦ä¸­æ­¢
   - channel ã®ã¿æŒ‡å®šã§ã‚‚ä¸­æ­¢
   - days ã¨ after/before ã®åŒæ™‚æŒ‡å®šã¯ã‚¨ãƒ©ãƒ¼
   - after > before ã®å ´åˆã¯ã‚¨ãƒ©ãƒ¼
   - afterãƒ»before ã®æ—¥ä»˜å½¢å¼ãŒä¸æ­£ãªå ´åˆã¯ã‚¨ãƒ©ãƒ¼
   â†“
3. æ¨©é™ãƒã‚§ãƒƒã‚¯
   - å®Ÿè¡Œè€…ã®æ¨©é™ç¢ºèª
   - Botã®æ¨©é™ç¢ºèª
   â†“
3.5. å®Ÿè¡Œç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼ˆskipConfirm = false ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ï¼‰
   - ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’ Ephemeral ã§è¡¨ç¤º
   - ã€Œâœ… å‰Šé™¤ã™ã‚‹ã€â†’ å‡¦ç†ç¶™ç¶šï¼ˆskipConfirm ãƒ•ãƒ©ã‚°ã‚’ä¿å­˜ã—ã¦æ¬¡ã‚¹ãƒ†ãƒƒãƒ—ã¸ï¼‰
   - ã€ŒâŒ ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€â†’ ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã¦çµ‚äº†
   - ã€Œæ¬¡å›ã‹ã‚‰ç¢ºèªã—ãªã„ã€â†’ ãƒˆã‚°ãƒ«æ›´æ–°ï¼ˆå‰Šé™¤ã™ã‚‹æŠ¼ä¸‹æ™‚ã« DB ä¿å­˜ï¼‰
   - 60ç§’ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ â†’ ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã¦çµ‚äº†
   â†“
4. æœŸé–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®è¨ˆç®—
   - days æŒ‡å®šã‚ã‚Š   â†’ afterTs = Date.now() - days * 86400000, beforeTs = Date.now()
   - after/before æŒ‡å®š â†’ å„æ—¥ä»˜æ–‡å­—åˆ—ã‚’ Unix ãƒŸãƒªç§’ã«å¤‰æ›
   - ã„ãšã‚Œã‚‚æœªæŒ‡å®š   â†’ afterTs = 0, beforeTs = Infinityï¼ˆæœŸé–“åˆ¶é™ãªã—ï¼‰
   â†“
5. å¯¾è±¡ãƒãƒ£ãƒ³ãƒãƒ«ãƒªã‚¹ãƒˆå–å¾—
   - channel æŒ‡å®šã‚ã‚Š â†’ ãã®ãƒãƒ£ãƒ³ãƒãƒ«ã®ã¿
   - channel æœªæŒ‡å®š   â†’ ã‚µãƒ¼ãƒãƒ¼å†…ã®å…¨ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒ³ãƒãƒ«
                        ï¼ˆBotãŒã‚¢ã‚¯ã‚»ã‚¹ä¸å¯ã®ãƒãƒ£ãƒ³ãƒãƒ«ã¯ã‚¹ã‚­ãƒƒãƒ—ã€ã‚¹ã‚­ãƒƒãƒ—æ•°ã‚’ãƒ­ã‚°è¨˜éŒ²ï¼‰
   â†“
6. ãƒãƒ£ãƒ³ãƒãƒ«ã”ã¨ã«ãƒ«ãƒ¼ãƒ—å‡¦ç†
   â”œâ”€â”€ 6a. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å–å¾—ï¼ˆãƒ«ãƒ¼ãƒ—ï¼‰
   â”‚    - 100ä»¶ãšã¤ãƒ•ã‚§ãƒƒãƒï¼ˆcount åˆè¨ˆã«é”ã™ã‚‹ã¾ã§ç¹°ã‚Šè¿”ã—ï¼‰
   â”‚    - user æŒ‡å®šãŒã‚ã‚‹å ´åˆã¯ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
   â”‚    - keyword æŒ‡å®šãŒã‚ã‚‹å ´åˆã¯æœ¬æ–‡ã®éƒ¨åˆ†ä¸€è‡´ï¼ˆcase-insensitiveï¼‰ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
   â”‚    - æœŸé–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼: afterTs â‰¤ msg.createdTimestamp â‰¤ beforeTs ã«ä¸€è‡´ã™ã‚‹ã‚‚ã®ã®ã¿åé›†
   â”‚    - ãƒ•ã‚§ãƒƒãƒã—ãŸãƒãƒƒãƒã®æœ€å¤ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ afterTs ã‚ˆã‚Šå‰ã«ãªã‚Œã°ã€ãã®ãƒãƒ£ãƒ³ãƒãƒ«ã®
   â”‚      èµ°æŸ»ã‚’æ‰“ã¡åˆ‡ã‚Šï¼ˆãã‚Œä»¥é™ã‚’å–å¾—ã—ã¦ã‚‚ç¯„å›²å¤–ã®ãŸã‚ï¼‰
   â”‚    - å…¨æ¡ä»¶ã«åˆè‡´ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’åé›†
   â”œâ”€â”€ 6b. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’14æ—¥ä»¥å†…/ä»¥é™ã«åˆ†é¡
   â”‚    - 14æ—¥ä»¥å†…: bulkDelete å¯¾è±¡
   â”‚    - 14æ—¥ä»¥é™: å€‹åˆ¥å‰Šé™¤å¯¾è±¡
   â””â”€â”€ 6c. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‰Šé™¤ï¼ˆãƒ«ãƒ¼ãƒ—ï¼‰
        - 14æ—¥ä»¥å†…: 100ä»¶ãšã¤ bulkDelete ã§é«˜é€Ÿå‰Šé™¤
        - 14æ—¥ä»¥é™: 1ä»¶ãšã¤å€‹åˆ¥å‰Šé™¤ï¼ˆãƒ¬ãƒ¼ãƒˆåˆ¶é™è€ƒæ…®ï¼‰
        - å‰Šé™¤é€²æ—ã‚’ãƒãƒ£ãƒ³ãƒãƒ«ã”ã¨ã«æ›´æ–°
   â†“
7. å…¨ãƒãƒ£ãƒ³ãƒãƒ«å‡¦ç†å®Œäº†
   â†“
8. çµæœé€šçŸ¥ï¼ˆEphemeralï¼‰
   - åˆè¨ˆå‰Šé™¤ä»¶æ•°ï¼ˆãƒãƒ£ãƒ³ãƒãƒ«åˆ¥å†…è¨³ã‚‚è¡¨ç¤ºï¼‰
   - å‰Šé™¤ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è©³ç´°ã‚’ãƒšãƒ¼ã‚¸ãƒã‚¤ã‚·ãƒ§ãƒ³ä»˜ã Embed ã§è¡¨ç¤º
     - å„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: æŠ•ç¨¿è€… / æŠ•ç¨¿æ—¥æ™‚ / ãƒãƒ£ãƒ³ãƒãƒ«å / ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æœ¬æ–‡
     - ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼: æŠ•ç¨¿è€…ãƒ»ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹ãƒ»æ—¥ä»˜ã§çµã‚Šè¾¼ã¿å¯èƒ½ï¼ˆã‚»ãƒ¬ã‚¯ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼/ãƒœã‚¿ãƒ³ï¼‰
   â†“
9. ãƒ­ã‚°è¨˜éŒ²
   - å®Ÿè¡Œè€…
   - åˆè¨ˆå‰Šé™¤ä»¶æ•°ãƒ»ãƒãƒ£ãƒ³ãƒãƒ«åˆ¥å‰Šé™¤ä»¶æ•°
   - å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆï¼‰
   - ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆï¼‰
   - æœŸé–“æ¡ä»¶ï¼ˆdays / after / before ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆï¼‰
```

---

## ï¿½ å‰Šé™¤çµæœã®è©³ç´°è¡¨ç¤º

### æ¦‚è¦

å‰Šé™¤å®Œäº†å¾Œã€ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œè€…ï¼ˆEphemeralï¼‰ã«å¯¾ã—ã¦ä»¥ä¸‹ã®æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ã€‚

1. **ã‚µãƒãƒªãƒ¼**: åˆè¨ˆå‰Šé™¤ä»¶æ•°ãƒ»ãƒãƒ£ãƒ³ãƒãƒ«åˆ¥å†…è¨³
2. **å‰Šé™¤ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§**: ãƒšãƒ¼ã‚¸ãƒã‚¤ã‚·ãƒ§ãƒ³ä»˜ãã® Discord Embed

---

### ã‚µãƒãƒªãƒ¼ Embed

```
âœ… å‰Šé™¤å®Œäº†
åˆè¨ˆå‰Šé™¤ä»¶æ•°: 45ä»¶

ãƒãƒ£ãƒ³ãƒãƒ«åˆ¥å†…è¨³:
  #general        : 20ä»¶
  #random         : 15ä»¶
  #spam-channel   : 10ä»¶
```

---

### å‰Šé™¤ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è©³ç´° Embedï¼ˆãƒšãƒ¼ã‚¸ãƒã‚¤ã‚·ãƒ§ãƒ³ï¼‰

#### 1ãƒšãƒ¼ã‚¸ã‚ãŸã‚Šã®è¡¨ç¤ºä»¶æ•°

- **5ä»¶** ã‚’1ãƒšãƒ¼ã‚¸ã¨ã—ã¦è¡¨ç¤ºï¼ˆEmbed ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ä¸Šé™ã‚’è€ƒæ…®ï¼‰

#### å„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¡¨ç¤ºå†…å®¹

| é …ç›®           | å†…å®¹                                               |
| -------------- | -------------------------------------------------- |
| æŠ•ç¨¿è€…         | `@ãƒ¦ãƒ¼ã‚¶ãƒ¼å` + ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ãƒã‚¿ãƒ¼                   |
| æŠ•ç¨¿æ—¥æ™‚       | `YYYY/MM/DD HH:mm:ss` (Discord ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—å½¢å¼) |
| ãƒãƒ£ãƒ³ãƒãƒ«     | `#ãƒãƒ£ãƒ³ãƒãƒ«å`                                    |
| ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æœ¬æ–‡ | æœ€å¤§200æ–‡å­—ï¼ˆè¶…éæ™‚ã¯ã€Œâ€¦ã€ã§çœç•¥ï¼‰                 |

#### Embed ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä¾‹ï¼ˆ1ãƒšãƒ¼ã‚¸ç›®ï¼‰

```
ğŸ“‹ å‰Šé™¤ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§  (1 / 9 ãƒšãƒ¼ã‚¸)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
[1] @Spammer#1234 | #general | 2026/02/25 10:30:15
    ã“ã‚Œã¯å®£ä¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã™ã€‚ä»Šã™ãã‚¯ãƒªãƒƒã‚¯ï¼

[2] @Spammer#1234 | #random | 2026/02/25 10:31:02
    ãŠå¾—ãªã‚µã‚¤ãƒˆã¯ã“ã¡ã‚‰â†’ http://...

[3] @Spammer#1234 | #general | 2026/02/25 11:00:45
    ãƒ•ã‚©ãƒ­ãƒ¼ãŠé¡˜ã„ã—ã¾ã™ï¼

[4] @BadUser#5678 | #general | 2026/02/24 09:15:33
    ä¸é©åˆ‡ãªç™ºè¨€ã®ä¾‹ã§ã™

[5] @Spammer#1234 | #spam-channel | 2026/02/23 22:05:11
    åºƒå‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã™

< å‰ã¸  |  1/9  |  æ¬¡ã¸ >
```

---

### ãƒšãƒ¼ã‚¸ãƒã‚¤ã‚·ãƒ§ãƒ³æ“ä½œ

#### ãƒœã‚¿ãƒ³

| ãƒœã‚¿ãƒ³   | èª¬æ˜                                 |
| -------- | ------------------------------------ |
| `â—€ å‰ã¸` | å‰ã®ãƒšãƒ¼ã‚¸ã¸ï¼ˆ1ãƒšãƒ¼ã‚¸ç›®ã§ã¯ç„¡åŠ¹åŒ–ï¼‰  |
| `â–¶ æ¬¡ã¸` | æ¬¡ã®ãƒšãƒ¼ã‚¸ã¸ï¼ˆæœ€çµ‚ãƒšãƒ¼ã‚¸ã§ã¯ç„¡åŠ¹åŒ–ï¼‰ |

#### Interaction ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ

- ãƒšãƒ¼ã‚¸ãƒã‚¤ã‚·ãƒ§ãƒ³æ“ä½œã¯ **15åˆ†é–“** æœ‰åŠ¹
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå¾Œã¯ãƒœã‚¿ãƒ³ã‚’ç„¡åŠ¹åŒ–ã—ã€ã€Œã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒæœŸé™åˆ‡ã‚Œã§ã™ã€ã¨è¡¨ç¤º

---

### ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½

å‰Šé™¤ä»¶æ•°ãŒè¤‡æ•°ã®å ´åˆã€ãƒšãƒ¼ã‚¸ãƒã‚¤ã‚·ãƒ§ãƒ³ Embed ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç”¨ã®ã‚»ãƒ¬ã‚¯ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¿½åŠ ã™ã‚‹ã€‚

#### ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç¨®åˆ¥

| ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼                | UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ         | èª¬æ˜                                                                          |
| ------------------------- | ------------------------- | ----------------------------------------------------------------------------- |
| **æŠ•ç¨¿è€…**                | Select Menuï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰ | è¡¨ç¤ºå¯¾è±¡ã®æŠ•ç¨¿è€…ã‚’çµã‚Šè¾¼ã‚€                                                    |
| **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹**        | Text Inputï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰    | å…¥åŠ›ã—ãŸã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿è¡¨ç¤º                                    |
| **éå»Næ—¥é–“ï¼ˆæ—¥æ•°å…¥åŠ›ï¼‰** | Text Inputï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰    | æ­£ã®æ•´æ•°ã‚’å…¥åŠ›ã€‚Næ—¥ä»¥å†…ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿è¡¨ç¤ºã€‚`after`/`before` ã¨æ’ä»–          |
| **afterï¼ˆé–‹å§‹æ—¥æ™‚ï¼‰**     | Text Inputï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰    | ã“ã®æ—¥æ™‚ä»¥é™ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿è¡¨ç¤ºã€‚å½¢å¼: `YYYY-MM-DD` or `YYYY-MM-DDTHH:MM:SS` |
| **beforeï¼ˆçµ‚äº†æ—¥æ™‚ï¼‰**    | Text Inputï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰    | ã“ã®æ—¥æ™‚ä»¥å‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿è¡¨ç¤ºã€‚å½¢å¼: `YYYY-MM-DD` or `YYYY-MM-DDTHH:MM:SS` |

> **æ³¨æ„**: éå»Næ—¥é–“ ã¨ after/before ã¯æ’ä»–ã€‚ä¸€æ–¹ã‚’å…¥åŠ›ã™ã‚‹ã¨ä»–æ–¹ã®å…¥åŠ›ã¯è‡ªå‹•ãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹ã€‚

#### ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨æ™‚ã®æŒ™å‹•

- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨å¾Œã¯ãƒšãƒ¼ã‚¸ç•ªå·ã‚’1ã«ãƒªã‚»ãƒƒãƒˆ
- è¤‡æ•°ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¯ AND æ¡ä»¶ã§é©ç”¨
- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ä¸­ã¯ Embed ã®ã‚¿ã‚¤ãƒˆãƒ«ã« `ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ä¸­ï¼‰` ã¨è¡¨ç¤º
- ã€Œãƒªã‚»ãƒƒãƒˆã€ãƒœã‚¿ãƒ³ã§ã™ã¹ã¦ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’è§£é™¤
- éå»Næ—¥é–“ã‚’å…¥åŠ›ã—ãŸå ´åˆã€after/before ã®å…¥åŠ›ã¯è‡ªå‹•ãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹ï¼ˆæ’ä»–ï¼‰
- after/before ã‚’å…¥åŠ›ã—ãŸå ´åˆã€éå»Næ—¥é–“ã®å…¥åŠ›ã¯è‡ªå‹•ãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹ï¼ˆæ’ä»–ï¼‰
- éå»Næ—¥é–“ã« 1 æœªæº€ã¾ãŸã¯æ•´æ•°ä»¥å¤–ã‚’å…¥åŠ›ã—ãŸå ´åˆã¯ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ Ephemeral ã§è¡¨ç¤ºã—ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¯é©ç”¨ã—ãªã„
- after/before ã«ç„¡åŠ¹ãªæ—¥ä»˜å½¢å¼ã‚’å…¥åŠ›ã—ãŸå ´åˆã¯ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ Ephemeral ã§è¡¨ç¤ºã—ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¯é©ç”¨ã—ãªã„
- after > before ã®å ´åˆã‚‚ã‚¨ãƒ©ãƒ¼ã‚’è¡¨ç¤ºã—ã¦ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¯é©ç”¨ã—ãªã„

#### ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ UI ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä¾‹

```
è¡Œ1: [æŠ•ç¨¿è€…ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ â–¼]
è¡Œ2: [éå»Næ—¥é–“ã‚’å…¥åŠ› ğŸ”¢]  [afterï¼ˆé–‹å§‹æ—¥æ™‚ï¼‰ã‚’å…¥åŠ› ğŸ“…]  [beforeï¼ˆçµ‚äº†æ—¥æ™‚ï¼‰ã‚’å…¥åŠ› ğŸ“…]  [å†…å®¹ã§æ¤œç´¢ ğŸ”]  [ãƒªã‚»ãƒƒãƒˆ âœ•]
è¡Œ3: [â—€ å‰ã¸]  [1/3]  [â–¶ æ¬¡ã¸]

ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ä¸­: æŠ•ç¨¿è€…=@Spammer#1234 | éå»7æ—¥ | after=2026-02-01 | before=2026-02-27ï¼‰
```

---

### å‰Šé™¤ä»¶æ•°ãŒ0ã®å ´åˆ

ãƒšãƒ¼ã‚¸ãƒã‚¤ã‚·ãƒ§ãƒ³ Embed ã¯è¡¨ç¤ºã›ãšã€ã‚µãƒãƒªãƒ¼ã®ã¿è¡¨ç¤ºã™ã‚‹ã€‚

```
â„¹ï¸ å‰Šé™¤å¯èƒ½ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
```

---

### å‰Šé™¤ä»¶æ•°ãŒ1ä»¶ã®å ´åˆ

ãƒšãƒ¼ã‚¸ãƒã‚¤ã‚·ãƒ§ãƒ³ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒœã‚¿ãƒ³ã¯è¡¨ç¤ºã›ãšã€1ä»¶ã®è©³ç´°ã®ã¿ Embed ã«è¡¨ç¤ºã™ã‚‹ã€‚

---

## ï¿½ğŸ“Š å®Ÿè£…ä¾‹

### TypeScriptå®Ÿè£…

```typescript
import {
  ActionRowBuilder,
  ButtonBuilder,
  ButtonStyle,
  ChatInputCommandInteraction,
  Collection,
  EmbedBuilder,
  GuildTextBasedChannel,
  Message,
  MessageFlags,
  PermissionFlagsBits,
  SlashCommandBuilder,
  StringSelectMenuBuilder,
  TextChannel,
} from "discord.js";

/** å‰Šé™¤æ¸ˆã¿ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¨˜éŒ² */
interface DeletedMessageRecord {
  authorId: string;
  authorTag: string;
  channelId: string;
  channelName: string;
  createdAt: Date;
  content: string;
}

const PAGE_SIZE = 5;

export const msgDelCommand: Command = {
  data: new SlashCommandBuilder()
    .setName("message-delete")
    .setDescription(
      "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¸€æ‹¬å‰Šé™¤ã—ã¾ã™ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: ã‚µãƒ¼ãƒãƒ¼å…¨ãƒãƒ£ãƒ³ãƒãƒ«ï¼‰",
    )
    .addIntegerOption((option) =>
      option
        .setName("count")
        .setDescription("å‰Šé™¤ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°ï¼ˆæœªæŒ‡å®šã§å…¨ä»¶å‰Šé™¤ï¼‰")
        .setRequired(false)
        .setMinValue(1),
    )
    .addUserOption((option) =>
      option
        .setName("user")
        .setDescription("ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿å‰Šé™¤")
        .setRequired(false),
    )
    .addStringOption((option) =>
      option
        .setName("keyword")
        .setDescription(
          "æœ¬æ–‡ã«æŒ‡å®šã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å«ã‚€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿å‰Šé™¤ï¼ˆéƒ¨åˆ†ä¸€è‡´ï¼‰",
        )
        .setRequired(false),
    )
    .addIntegerOption((option) =>
      option
        .setName("days")
        .setDescription(
          "éå»Næ—¥ä»¥å†…ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿å‰Šé™¤ï¼ˆafter/beforeã¨ã®åŒæ™‚æŒ‡å®šä¸å¯ï¼‰",
        )
        .setRequired(false)
        .setMinValue(1),
    )
    .addStringOption((option) =>
      option
        .setName("after")
        .setDescription(
          "ã“ã®æ—¥æ™‚ä»¥é™ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿å‰Šé™¤ (YYYY-MM-DD ã¾ãŸã¯ YYYY-MM-DDTHH:MM:SS)",
        )
        .setRequired(false),
    )
    .addStringOption((option) =>
      option
        .setName("before")
        .setDescription(
          "ã“ã®æ—¥æ™‚ä»¥å‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿å‰Šé™¤ (YYYY-MM-DD ã¾ãŸã¯ YYYY-MM-DDTHH:MM:SS)",
        )
        .setRequired(false),
    )
    .addChannelOption((option) =>
      option
        .setName("channel")
        .setDescription("å‰Šé™¤å¯¾è±¡ã‚’çµã‚Šè¾¼ã‚€ãƒãƒ£ãƒ³ãƒãƒ«ï¼ˆæœªæŒ‡å®šã§ã‚µãƒ¼ãƒãƒ¼å…¨ä½“ï¼‰")
        .setRequired(false),
    )
    .setDefaultMemberPermissions(PermissionFlagsBits.ManageMessages),

  async execute(interaction: ChatInputCommandInteraction) {
    await interaction.deferReply({ flags: MessageFlags.Ephemeral });

    const countOption = interaction.options.getInteger("count");
    const targetUser = interaction.options.getUser("user", false);
    const keyword = interaction.options.getString("keyword", false);
    const daysOption = interaction.options.getInteger("days", false);
    const afterStr = interaction.options.getString("after", false);
    const beforeStr = interaction.options.getString("before", false);
    const channelOption = interaction.options.getChannel("channel", false);

    // ãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶ãŒä½•ã‚‚ãªã„å ´åˆã¯æ‹’å¦
    if (
      !countOption &&
      !targetUser &&
      !keyword &&
      !daysOption &&
      !afterStr &&
      !beforeStr
    ) {
      await interaction.editReply(
        "âš ï¸ è­¦å‘Š: ãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„ãŸã‚å®Ÿè¡Œã§ãã¾ã›ã‚“ã€‚\n" +
          "`count`ãƒ»`user`ãƒ»`keyword`ãƒ»`days`ãƒ»`after`ãƒ»`before` ã®ã„ãšã‚Œã‹1ã¤ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚",
      );
      return;
    }

    // days ã¨ after/before ã®æ’ä»–ãƒã‚§ãƒƒã‚¯
    if (daysOption && (afterStr || beforeStr)) {
      await interaction.editReply(
        "âš ï¸ `days` ã¨ `after`/`before` ã¯åŒæ™‚ã«æŒ‡å®šã§ãã¾ã›ã‚“ã€‚ã©ã¡ã‚‰ã‹ä¸€æ–¹ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚",
      );
      return;
    }

    // afterãƒ»before ã®æ—¥ä»˜ãƒ‘ãƒ¼ã‚¹ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    const parseDate = (str: string, endOfDay = false): Date | null => {
      // YYYY-MM-DD ã®å ´åˆã¯æ™‚åˆ»ã‚’è£œå®Œ
      const normalized = /^\d{4}-\d{2}-\d{2}$/.test(str)
        ? `${str}T${endOfDay ? "23:59:59" : "00:00:00"}`
        : str;
      const d = new Date(normalized);
      return isNaN(d.getTime()) ? null : d;
    };

    let afterTs = 0;
    let beforeTs = Infinity;

    if (daysOption) {
      afterTs = Date.now() - daysOption * 24 * 60 * 60 * 1000;
      beforeTs = Date.now();
    } else {
      if (afterStr) {
        const d = parseDate(afterStr, false);
        if (!d) {
          await interaction.editReply(
            "âš ï¸ `after` ã®æ—¥ä»˜å½¢å¼ãŒä¸æ­£ã§ã™ã€‚`YYYY-MM-DD` ã¾ãŸã¯ `YYYY-MM-DDTHH:MM:SS` å½¢å¼ã§æŒ‡å®šã—ã¦ãã ã•ã„ã€‚",
          );
          return;
        }
        afterTs = d.getTime();
      }
      if (beforeStr) {
        const d = parseDate(beforeStr, true);
        if (!d) {
          await interaction.editReply(
            "âš ï¸ `before` ã®æ—¥ä»˜å½¢å¼ãŒä¸æ­£ã§ã™ã€‚`YYYY-MM-DD` ã¾ãŸã¯ `YYYY-MM-DDTHH:MM:SS` å½¢å¼ã§æŒ‡å®šã—ã¦ãã ã•ã„ã€‚",
          );
          return;
        }
        beforeTs = d.getTime();
      }
      if (afterTs !== 0 && beforeTs !== Infinity && afterTs > beforeTs) {
        await interaction.editReply(
          "âš ï¸ `after` ã¯ `before` ã‚ˆã‚Šå‰ã®æ—¥æ™‚ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚",
        );
        return;
      }
    }

    const count = countOption ?? Infinity;
    const guild = interaction.guild!;

    // å¯¾è±¡ãƒãƒ£ãƒ³ãƒãƒ«ãƒªã‚¹ãƒˆã®æ§‹ç¯‰
    let targetChannels: GuildTextBasedChannel[];
    if (channelOption) {
      if (!channelOption.isTextBased()) {
        await interaction.editReply("ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒ³ãƒãƒ«ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚");
        return;
      }
      targetChannels = [channelOption as GuildTextBasedChannel];
    } else {
      // ã‚µãƒ¼ãƒãƒ¼å†…ã®å…¨ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒ³ãƒãƒ«ï¼ˆBotãŒã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªã‚‚ã®ï¼‰
      const allChannels = await guild.channels.fetch();
      targetChannels = allChannels
        .filter(
          (ch): ch is TextChannel =>
            ch !== null &&
            ch.isTextBased() &&
            ch
              .permissionsFor(guild.members.me!)
              ?.has([
                PermissionFlagsBits.ReadMessageHistory,
                PermissionFlagsBits.ManageMessages,
              ]) === true,
        )
        .values()
        .toArray();
    }

    try {
      const twoWeeksAgo = Date.now() - 14 * 24 * 60 * 60 * 1000;
      const deletedRecords: DeletedMessageRecord[] = [];
      const channelBreakdown: Record<string, number> = {};
      let totalDeleted = 0;

      for (const channel of targetChannels) {
        const collected: Message[] = [];
        let lastId: string | undefined;

        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸åé›†ï¼ˆcount ã®æ®‹ã‚Šä»¶æ•°ã¾ã§ï¼‰
        while (totalDeleted + collected.length < count) {
          const batch: Collection<string, Message> =
            await channel.messages.fetch({
              limit: 100,
              before: lastId,
            });

          if (batch.size === 0) break;

          let batchOldestTs = Infinity;

          for (const msg of batch.values()) {
            batchOldestTs = Math.min(batchOldestTs, msg.createdTimestamp);
            // æœŸé–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
            if (msg.createdTimestamp < afterTs) continue;
            if (msg.createdTimestamp > beforeTs) continue;
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
            if (targetUser && msg.author.id !== targetUser.id) continue;
            // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰éƒ¨åˆ†ä¸€è‡´ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆcase-insensitiveï¼‰
            if (
              keyword &&
              !msg.content.toLowerCase().includes(keyword.toLowerCase())
            )
              continue;
            collected.push(msg);
            if (totalDeleted + collected.length >= count) break;
          }

          lastId = batch.last()?.id;
          // ãƒãƒƒãƒæœ€å¤ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ afterTs ã‚ˆã‚Šå‰ãªã‚‰ã€ãã‚Œä»¥é™ã‚’å–å¾—ã—ã¦ã‚‚ç¯„å›²å¤–ãªã®ã§æ‰“ã¡åˆ‡ã‚Š
          if (batchOldestTs < afterTs) break;
          if (batch.size < 100) break;
        }

        if (collected.length === 0) continue;

        // 14æ—¥ä»¥å†…/ä»¥é™ã«åˆ†é¡
        const newMsgs = collected.filter(
          (m) => m.createdTimestamp > twoWeeksAgo,
        );
        const oldMsgs = collected.filter(
          (m) => m.createdTimestamp <= twoWeeksAgo,
        );

        // é€²æ—è¡¨ç¤º
        await interaction.editReply(
          `å‰Šé™¤ä¸­... (${channel.name}) åé›†: ${collected.length}ä»¶`,
        );

        // bulkDeleteï¼ˆ14æ—¥ä»¥å†…ï¼‰
        for (let i = 0; i < newMsgs.length; i += 100) {
          const chunk = newMsgs.slice(i, i + 100);
          await channel.bulkDelete(chunk, true);
          totalDeleted += chunk.length;
          if (i + 100 < newMsgs.length) {
            await new Promise((r) => setTimeout(r, 1000));
          }
        }

        // å€‹åˆ¥å‰Šé™¤ï¼ˆ14æ—¥ä»¥é™ï¼‰
        for (const msg of oldMsgs) {
          try {
            await msg.delete();
            totalDeleted++;
          } catch (err) {
            logger.warn(`[MsgDel] Failed to delete message ${msg.id}:`, err);
          }
          await new Promise((r) => setTimeout(r, 500));
        }

        // å‰Šé™¤æ¸ˆã¿ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¨˜éŒ²
        for (const msg of collected) {
          deletedRecords.push({
            authorId: msg.author.id,
            authorTag: msg.author.tag,
            channelId: channel.id,
            channelName: channel.name,
            createdAt: msg.createdAt,
            content:
              msg.content.slice(0, 200) + (msg.content.length > 200 ? "â€¦" : ""),
          });
        }

        channelBreakdown[channel.name] = collected.length;
      }

      if (totalDeleted === 0) {
        await interaction.editReply(
          "â„¹ï¸ å‰Šé™¤å¯èƒ½ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚",
        );
        return;
      }

      // --- ã‚µãƒãƒªãƒ¼ Embed ---
      const breakdownText = Object.entries(channelBreakdown)
        .map(([ch, n]) => `#${ch}: ${n}ä»¶`)
        .join("\n");

      const summaryEmbed = new EmbedBuilder()
        .setColor(0x2ecc71)
        .setTitle("âœ… å‰Šé™¤å®Œäº†")
        .addFields(
          { name: "åˆè¨ˆå‰Šé™¤ä»¶æ•°", value: `${totalDeleted}ä»¶`, inline: true },
          { name: "ãƒãƒ£ãƒ³ãƒãƒ«åˆ¥å†…è¨³", value: breakdownText || "â€”" },
        );

      // 1ä»¶ã®ã¿ã®å ´åˆã¯ãƒœã‚¿ãƒ³ãªã—ã§è©³ç´°ã‚‚è¡¨ç¤º
      if (deletedRecords.length === 1) {
        const r = deletedRecords[0];
        summaryEmbed.addFields({
          name: `[1] @${r.authorTag} | #${r.channelName}`,
          value: `${r.createdAt.toLocaleString("ja-JP")}\n${r.content || "*(æœ¬æ–‡ãªã—)*"}`,
        });
        await interaction.editReply({ embeds: [summaryEmbed] });
        return;
      }

      // --- ãƒšãƒ¼ã‚¸ãƒã‚¤ã‚·ãƒ§ãƒ³ä»˜ãè©³ç´° Embed ---
      await sendPaginatedResult(interaction, summaryEmbed, deletedRecords);

      const periodLabel = daysOption
        ? `days=${daysOption}`
        : [afterStr && `after=${afterStr}`, beforeStr && `before=${beforeStr}`]
            .filter(Boolean)
            .join(" ") || "";

      logger.info(
        `[MsgDel] ${interaction.user.tag} deleted ${totalDeleted} messages` +
          `${targetUser ? ` from ${targetUser.tag}` : ""}` +
          `${keyword ? ` keyword="${keyword}"` : ""}` +
          `${periodLabel ? ` ${periodLabel}` : ""}` +
          ` channels=[${Object.keys(channelBreakdown).join(", ")}]`,
      );
    } catch (error) {
      logger.error("[MsgDel] Error:", error);
      await interaction.editReply("ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å‰Šé™¤ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚");
    }
  },

  cooldown: 5,
};

/**
 * å‰Šé™¤æ¸ˆã¿ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§ã‚’ãƒšãƒ¼ã‚¸ãƒã‚¤ã‚·ãƒ§ãƒ³ + ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ä»˜ã Embed ã§é€ä¿¡ã™ã‚‹ã€‚
 */
async function sendPaginatedResult(
  interaction: ChatInputCommandInteraction,
  summaryEmbed: EmbedBuilder,
  records: DeletedMessageRecord[],
  filterAuthorId?: string,
  filterKeyword?: string,
  filterDays?: number,   // éå»Næ—¥é–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆafter/before ã¨æ’ä»–ï¼‰
  filterAfter?: Date,    // afterï¼ˆé–‹å§‹æ—¥æ™‚ï¼‰ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
  filterBefore?: Date,   // beforeï¼ˆçµ‚äº†æ—¥æ™‚ï¼‰ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
): Promise<void> {
  // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
  let filtered = records;
  if (filterAuthorId) {
    filtered = filtered.filter((r) => r.authorId === filterAuthorId);
  }
  if (filterKeyword) {
    const kw = filterKeyword.toLowerCase();
    filtered = filtered.filter((r) => r.content.toLowerCase().includes(kw));
  }
  // éå»Næ—¥é–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆafter/before ãŒæœªæŒ‡å®šã®å ´åˆã®ã¿é©ç”¨ï¼‰
  if (filterDays && !filterAfter && !filterBefore) {
    const threshold = Date.now() - filterDays * 24 * 60 * 60 * 1000;
    filtered = filtered.filter((r) => r.createdAt.getTime() >= threshold);
  }
  // after/before ã«ã‚ˆã‚‹æ—¥ä»˜ç¯„å›²ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆdays ã‚ˆã‚Šå„ªå…ˆï¼‰
  if (filterAfter) {
    filtered = filtered.filter((r) => r.createdAt >= filterAfter!);
  }
  if (filterBefore) {
    filtered = filtered.filter((r) => r.createdAt <= filterBefore!);
  }

  const totalPages = Math.ceil(filtered.length / PAGE_SIZE);
  let currentPage = 0;

  const buildDetailEmbed = (page: number): EmbedBuilder => {
    const start = page * PAGE_SIZE;
    const slice = filtered.slice(start, start + PAGE_SIZE);
    const embed = new EmbedBuilder()
      .setColor(0x3498db)
      .setTitle(
        `ğŸ“‹ å‰Šé™¤ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§  (${page + 1} / ${totalPages} ãƒšãƒ¼ã‚¸)` +
          (filterAuthorId || filterKeyword || filterDays || filterAfter || filterBefore
            ? " ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ä¸­ï¼‰"
            : ""),
      ).setFooter(
        filterAfter || filterBefore
          ? {
              text:
                [filterAfter && `after: ${filterAfter.toLocaleDateString("ja-JP")}`, filterBefore && `before: ${filterBefore.toLocaleDateString("ja-JP")}`]
                  .filter(Boolean)
                  .join(" ï½ "),
            }
          : null,
      ),
      );
    for (let i = 0; i < slice.length; i++) {
      const r = slice[i];
      embed.addFields({
        name: `[${start + i + 1}] @${r.authorTag} | #${r.channelName}`,
        value: `${r.createdAt.toLocaleString("ja-JP")}\n${r.content || "*(æœ¬æ–‡ãªã—)*"}`,
      });
    }
    return embed;
  };

  const buildComponents = (page: number) => {
    const navRow = new ActionRowBuilder<ButtonBuilder>().addComponents(
      new ButtonBuilder()
        .setCustomId("msgdel_prev")
        .setLabel("â—€ å‰ã¸")
        .setStyle(ButtonStyle.Secondary)
        .setDisabled(page === 0),
      new ButtonBuilder()
        .setCustomId("msgdel_next")
        .setLabel("â–¶ æ¬¡ã¸")
        .setStyle(ButtonStyle.Secondary)
        .setDisabled(page >= totalPages - 1),
    );

    // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¡Œï¼ˆè¤‡æ•°ä»¶ã®å ´åˆã®ã¿ï¼‰
    const uniqueAuthors = [...new Set(records.map((r) => r.authorTag))];
    const authorSelect = new StringSelectMenuBuilder()
      .setCustomId("msgdel_filter_author")
      .setPlaceholder("æŠ•ç¨¿è€…ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼")
      .setMinValues(0)
      .setMaxValues(Math.min(uniqueAuthors.length, 25))
      .addOptions(
        uniqueAuthors.slice(0, 25).map((tag) => ({ label: tag, value: tag })),
      );
    const dateRow = new ActionRowBuilder<ButtonBuilder>().addComponents(
      new ButtonBuilder()
        .setCustomId("msgdel_filter_days")
        .setLabel(
          filterDays
            ? `éå»${filterDays}æ—¥é–“ âœï¸`
            : "éå»Næ—¥é–“ã‚’å…¥åŠ› ğŸ”¢",
        )
        // days æŒ‡å®šä¸­ã¯ç·‘ã€after/before æŒ‡å®šä¸­ã¯ç„¡åŠ¹åŒ–
        .setStyle(filterDays ? ButtonStyle.Success : ButtonStyle.Secondary)
        .setDisabled(!!(filterAfter || filterBefore)),
      new ButtonBuilder()
        .setCustomId("msgdel_filter_after")
        .setLabel(
          filterAfter
            ? `after: ${filterAfter.toLocaleDateString("ja-JP")} âœï¸`
            : "afterï¼ˆé–‹å§‹æ—¥æ™‚ï¼‰ã‚’å…¥åŠ› ğŸ“…",
        )
        // after æŒ‡å®šä¸­ã¯ç·‘ã€days æŒ‡å®šä¸­ã¯ç„¡åŠ¹åŒ–
        .setStyle(filterAfter ? ButtonStyle.Success : ButtonStyle.Secondary)
        .setDisabled(!!filterDays),
      new ButtonBuilder()
        .setCustomId("msgdel_filter_before")
        .setLabel(
          filterBefore
            ? `before: ${filterBefore.toLocaleDateString("ja-JP")} âœï¸`
            : "beforeï¼ˆçµ‚äº†æ—¥æ™‚ï¼‰ã‚’å…¥åŠ› ğŸ“…",
        )
        // before æŒ‡å®šä¸­ã¯ç·‘ã€days æŒ‡å®šä¸­ã¯ç„¡åŠ¹åŒ–
        .setStyle(filterBefore ? ButtonStyle.Success : ButtonStyle.Secondary)
        .setDisabled(!!filterDays),
      new ButtonBuilder()
        .setCustomId("msgdel_filter_keyword")
        .setLabel("å†…å®¹ã§æ¤œç´¢ ğŸ”")
        .setStyle(ButtonStyle.Primary),
      new ButtonBuilder()
        .setCustomId("msgdel_filter_reset")
        .setLabel("ãƒªã‚»ãƒƒãƒˆ âœ•")
        .setStyle(ButtonStyle.Danger),
    );

    return [
      new ActionRowBuilder<StringSelectMenuBuilder>().addComponents(
        authorSelect,
      ),
      dateRow,
      navRow,
    ];
  };

  const response = await interaction.editReply({
    embeds: [summaryEmbed, buildDetailEmbed(currentPage)],
    components: buildComponents(currentPage),
  });

  // 15åˆ†é–“ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã‚’å¾…æ©Ÿ
  const collector = response.createMessageComponentCollector({
    time: 15 * 60 * 1000,
  });

  collector.on("collect", async (i) => {
    if (i.user.id !== interaction.user.id) {
      await i.reply({
        content: "æ“ä½œæ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚",
        flags: MessageFlags.Ephemeral,
      });
      return;
    }
    if (i.customId === "msgdel_prev")
      currentPage = Math.max(0, currentPage - 1);
    if (i.customId === "msgdel_next")
      currentPage = Math.min(totalPages - 1, currentPage + 1);
    // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å‡¦ç†ã¯å®Ÿè£…å´ã§ i.customId ã«å¿œã˜ã¦åˆ†å²
    await i.update({
      embeds: [summaryEmbed, buildDetailEmbed(currentPage)],
      components: buildComponents(currentPage),
    });
  });

  collector.on("end", async () => {
    await interaction.editReply({ components: [] }).catch(() => {});
  });
}
```

**Cooldownã®å®Ÿè£…è©³ç´°:**

- å„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«æœ€å¾Œã®ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œæ™‚åˆ»ã‚’è¨˜éŒ²
- åŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ5ç§’ä»¥å†…ã«å†å®Ÿè¡Œã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
- ç•°ãªã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯å€‹åˆ¥ã«cooldownãŒç®¡ç†ã•ã‚Œã‚‹

---

**å®Ÿè¡Œç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®å®Ÿè£…:**

```typescript
/**
 * å®Ÿè¡Œç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤ºã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å¿œç­”ã‚’å¾…ã¤ã€‚
 * @returns `"confirmed"` | `"cancelled"` | `"timeout"`
 */
async function showConfirmDialog(
  interaction: ChatInputCommandInteraction,
  summary: string,
): Promise<"confirmed" | "cancelled" | "timeout"> {
  let skipNext = false; // ã€Œæ¬¡å›ã‹ã‚‰ç¢ºèªã—ãªã„ã€ãƒˆã‚°ãƒ«çŠ¶æ…‹

  const buildButtons = () =>
    new ActionRowBuilder<ButtonBuilder>().addComponents(
      new ButtonBuilder()
        .setCustomId("msgdel_confirm_yes")
        .setLabel("âœ… å‰Šé™¤ã™ã‚‹")
        .setStyle(ButtonStyle.Danger),
      new ButtonBuilder()
        .setCustomId("msgdel_confirm_no")
        .setLabel("âŒ ã‚­ãƒ£ãƒ³ã‚»ãƒ«")
        .setStyle(ButtonStyle.Secondary),
      new ButtonBuilder()
        .setCustomId("msgdel_confirm_skip_toggle")
        .setLabel(
          skipNext ? "[âœ“] æ¬¡å›ã‹ã‚‰ç¢ºèªã—ãªã„" : "[ ] æ¬¡å›ã‹ã‚‰ç¢ºèªã—ãªã„",
        )
        .setStyle(skipNext ? ButtonStyle.Success : ButtonStyle.Secondary),
    );

  const response = await interaction.editReply({
    content: `âš ï¸ **ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“**\n\n${summary}\n\nå®Ÿè¡Œã—ã¾ã™ã‹ï¼Ÿ`,
    components: [buildButtons()],
  });

  return new Promise((resolve) => {
    const collector = response.createMessageComponentCollector({
      time: 60_000,
    });

    collector.on("collect", async (i) => {
      if (i.user.id !== interaction.user.id) {
        await i.reply({
          content: "æ“ä½œæ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚",
          flags: MessageFlags.Ephemeral,
        });
        return;
      }

      if (i.customId === "msgdel_confirm_skip_toggle") {
        skipNext = !skipNext;
        await i.update({ components: [buildButtons()] });
        return;
      }

      collector.stop(i.customId);
    });

    collector.on("end", async (_, reason) => {
      if (reason === "msgdel_confirm_yes") {
        if (skipNext) {
          await saveUserSetting(interaction.user.id, interaction.guildId!, {
            skipConfirm: true,
          });
        }
        resolve("confirmed");
      } else if (reason === "msgdel_confirm_no") {
        await interaction.editReply({
          content: "âŒ å‰Šé™¤ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸã€‚",
          components: [],
        });
        resolve("cancelled");
      } else {
        // time out
        await interaction.editReply({
          content: "âŒ› ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸã€‚å†åº¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚",
          components: [],
        });
        resolve("timeout");
      }
    });
  });
}

/**
 * ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šã‚’ DB ã«ä¿å­˜ã™ã‚‹ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆå®Ÿè£…çœç•¥ï¼‰ã€‚
 */
async function saveUserSetting(
  userId: string,
  guildId: string,
  patch: { skipConfirm?: boolean },
): Promise<void> {
  // DB ã® user_settings ãƒ†ãƒ¼ãƒ–ãƒ«ã« upsert ã™ã‚‹
}

/**
 * ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šã‚’ DB ã‹ã‚‰å–å¾—ã™ã‚‹ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼ˆå®Ÿè£…çœç•¥ï¼‰ã€‚
 */
async function getUserSetting(
  userId: string,
  guildId: string,
): Promise<{ skipConfirm: boolean }> {
  // DB ã‹ã‚‰å–å¾—ã€‚æœªç™»éŒ²ã®å ´åˆã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ { skipConfirm: false } ã‚’è¿”ã™
  return { skipConfirm: false };
}
```

**`execute` å†…ã§ã®ä½¿ç”¨ä¾‹:**

```typescript
// æ¨©é™ãƒã‚§ãƒƒã‚¯å¾Œã€å‰Šé™¤å‡¦ç†é–‹å§‹å‰ã«æŒ¿å…¥
const { skipConfirm } = await getUserSetting(interaction.user.id, guild.id);
if (!skipConfirm) {
  const conditionSummary = buildConditionSummary({
    targetUser,
    keyword,
    daysOption,
    afterStr,
    beforeStr,
    channelOption,
  });
  const result = await showConfirmDialog(interaction, conditionSummary);
  if (result !== "confirmed") return;
}
```

---

## âš ï¸ Discord APIåˆ¶é™

### 14æ—¥åˆ¶é™ï¼ˆbulkDeleteï¼‰

Discordã®`bulkDelete`ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€**14æ—¥ä»¥ä¸Šå‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤ã§ãã¾ã›ã‚“**ã€‚

**å¯¾å¿œ:**

- **14æ—¥ä»¥å†…**: `bulkDelete()`ã§é«˜é€Ÿä¸€æ‹¬å‰Šé™¤ï¼ˆ100ä»¶ãšã¤ï¼‰
- **14æ—¥ä»¥é™**: `message.delete()`ã§å€‹åˆ¥å‰Šé™¤ï¼ˆ1ä»¶ãšã¤ã€æ™‚é–“ãŒã‹ã‹ã‚‹ï¼‰
- å‰Šé™¤å¯¾è±¡ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªå‹•çš„ã«åˆ†é¡ã—ã¦é©åˆ‡ãªæ–¹æ³•ã§å‰Šé™¤

**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹:**

- ä¸€æ‹¬å‰Šé™¤: 100ä»¶ã‚’æ•°ç§’ã§å‰Šé™¤
- å€‹åˆ¥å‰Šé™¤: 1ä»¶ã‚ãŸã‚Šç´„0.5ç§’ï¼ˆãƒ¬ãƒ¼ãƒˆåˆ¶é™è€ƒæ…®ï¼‰
  - ä¾‹: 100ä»¶ã®å€‹åˆ¥å‰Šé™¤ â†’ ç´„50ç§’
  - ä¾‹: 500ä»¶ã®å€‹åˆ¥å‰Šé™¤ â†’ ç´„250ç§’ï¼ˆç´„4åˆ†ï¼‰

### ãƒ¬ãƒ¼ãƒˆåˆ¶é™

- ä¸€åº¦ã«å‰Šé™¤ã§ãã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°: æœ€å¤§100ä»¶ï¼ˆbulkDeleteåˆ¶é™ï¼‰
- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ã‚§ãƒƒãƒ: 100ä»¶ãšã¤
- ãƒ¬ãƒ¼ãƒˆåˆ¶é™: é©åˆ‡ãªé–“éš”ã‚’ç©ºã‘ã‚‹å¿…è¦ã‚ã‚Š

**å¯¾å¿œ:**

- 100ä»¶ãšã¤ã«åˆ†å‰²ã—ã¦ãƒ•ã‚§ãƒƒãƒãƒ»å‰Šé™¤
- å‰Šé™¤ãƒãƒƒãƒé–“ã«1ç§’ã®å¾…æ©Ÿæ™‚é–“ã‚’æŒ¿å…¥
- å¤§é‡å‰Šé™¤æ™‚ã¯é€²æ—ã‚’è¡¨ç¤º

---

## ğŸ›¡ï¸ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### æƒ³å®šã•ã‚Œã‚‹ã‚¨ãƒ©ãƒ¼

1. **`count`ãƒ»`user`ãƒ»`keyword` ã®å…¨æœªæŒ‡å®š**

   ```
   âš ï¸ è­¦å‘Š: `count`ãƒ»`user`ãƒ»`keyword` ã®ã„ãšã‚Œã‚‚æœªæŒ‡å®šã®ãŸã‚å®Ÿè¡Œã§ãã¾ã›ã‚“ã€‚
   å°‘ãªãã¨ã‚‚ `count`ãƒ»`user`ãƒ»`keyword` ã®ã„ãšã‚Œã‹1ã¤ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚
   ```

2. **æ¨©é™ä¸è¶³**

   ```
   âŒ ã“ã®æ“ä½œã‚’å®Ÿè¡Œã™ã‚‹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚
   å¿…è¦ãªæ¨©é™: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç®¡ç†
   ```

3. **Botæ¨©é™ä¸è¶³**

   ```
   âŒ Botã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‰Šé™¤æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚
   ```

4. **å¤ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å€‹åˆ¥å‰Šé™¤ï¼ˆæ™‚é–“ãŒã‹ã‹ã‚‹ï¼‰**

   ```
   âš ï¸ 14æ—¥ä»¥ä¸Šå‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯å€‹åˆ¥å‰Šé™¤ã—ã¾ã™ã€‚æ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
   å‰Šé™¤ä¸­... (general) 50/200ä»¶
   ```

5. **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚‰ãªã„**

   ```
   â„¹ï¸ å‰Šé™¤å¯èƒ½ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚
   ```

6. **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ—¢ã«å‰Šé™¤ã•ã‚Œã¦ã„ã‚‹ï¼ˆåŒæ™‚å®Ÿè¡Œæ™‚ï¼‰**
   - ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒåŒæ™‚ã«å‰Šé™¤ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ãŸå ´åˆ
   - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ—¢ã«å‰Šé™¤ã•ã‚Œã¦ã„ã‚‹ã‚¨ãƒ©ãƒ¼ã¯ç„¡è¦–ã—ã¦å‡¦ç†ã‚’ç¶™ç¶š
   - ãƒ­ã‚°ã«è­¦å‘Šã‚’è¨˜éŒ²ï¼ˆå‰Šé™¤å¤±æ•—ä»¶æ•°ã¯å«ã‚ãªã„ï¼‰

7. **`days` ã¨ `after`/`before` ã®åŒæ™‚æŒ‡å®š**

   ```
   âš ï¸ `days` ã¨ `after`/`before` ã¯åŒæ™‚ã«æŒ‡å®šã§ãã¾ã›ã‚“ã€‚ã©ã¡ã‚‰ã‹ä¸€æ–¹ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚
   ```

8. **`after` / `before` ã®æ—¥ä»˜å½¢å¼ãŒä¸æ­£**

   ```
   âš ï¸ `after` ã®æ—¥ä»˜å½¢å¼ãŒä¸æ­£ã§ã™ã€‚`YYYY-MM-DD` ã¾ãŸã¯ `YYYY-MM-DDTHH:MM:SS` å½¢å¼ã§æŒ‡å®šã—ã¦ãã ã•ã„ã€‚
   ```

9. **`after` ãŒ `before` ã‚ˆã‚Šå¾Œ**

   ```
   âš ï¸ `after` ã¯ `before` ã‚ˆã‚Šå‰ã®æ—¥æ™‚ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚
   ```

10. **å®Ÿè¡Œç¢ºèªã®ã‚­ãƒ£ãƒ³ã‚»ãƒ«**

    ```
    âŒ å‰Šé™¤ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸã€‚
    ```

11. **å®Ÿè¡Œç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆ60ç§’ï¼‰**

    ```
    âŒ› ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸã€‚å†åº¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚
    ```

12. **ãƒšãƒ¼ã‚¸ãƒã‚¤ã‚·ãƒ§ãƒ³ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ**
    - 15åˆ†é–“æ“ä½œãŒãªã‹ã£ãŸå ´åˆ
    - ãƒœã‚¿ãƒ³ãƒ»ã‚»ãƒ¬ã‚¯ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’ç„¡åŠ¹åŒ–ã—ã€ã€Œã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒæœŸé™åˆ‡ã‚Œã§ã™ã€ã¨è¡¨ç¤º

---

## ğŸ“ ãƒ­ã‚°è¨˜éŒ²

### ãƒ­ã‚°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

```
[MsgDel] <å®Ÿè¡Œè€…> deleted <åˆè¨ˆå‰Šé™¤ä»¶æ•°> messages [from <å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼>] [keyword="<ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰>"] [days=<N> | after=<æ—¥æ™‚> before=<æ—¥æ™‚>] channels=[<ãƒãƒ£ãƒ³ãƒãƒ«å, ...>]
```

### ä¾‹

```
[MsgDel] Admin#1234 deleted 50 messages from Spammer#5678 channels=[general, random]
[MsgDel] Moderator#4321 deleted 100 messages keyword="åºƒå‘Š" channels=[general, spam-channel, announcements]
[MsgDel] Admin#1234 deleted 30 messages from BadUser#9999 keyword="spam" channels=[general]
[MsgDel] Moderator#4321 deleted 80 messages from Spammer#5678 days=7 channels=[general, random]
[MsgDel] Admin#1234 deleted 45 messages after=2026-02-01 before=2026-02-27 channels=[general]
```

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

æœ€æ–°ã®ä»¶æ•°ã¨ã‚«ãƒãƒ¬ãƒƒã‚¸ã¯ [TEST_PROGRESS.md](../progress/TEST_PROGRESS.md) ã‚’å‚ç…§ã€‚

### ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ

- [ ] æ¨©é™ãƒã‚§ãƒƒã‚¯
- [ ] `count`ãƒ»`user`ãƒ»`keyword` å…¨æœªæŒ‡å®šæ™‚ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ‹’å¦
- [ ] `channel` ã®ã¿æŒ‡å®šæ™‚ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ‹’å¦
- [ ] ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰éƒ¨åˆ†ä¸€è‡´ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆå¤§æ–‡å­—å°æ–‡å­—ã‚’åŒºåˆ¥ã—ãªã„ï¼‰
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ + ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è¤‡åˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
- [ ] ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æŒ‡å®šï¼‰
- [ ] 14æ—¥åˆ¶é™ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
- [ ] ä»¶æ•°åˆ¶é™ï¼ˆå…¨ãƒãƒ£ãƒ³ãƒãƒ«åˆè¨ˆã§ä¸Šé™ã«é”ã—ãŸå ´åˆï¼‰
- [ ] count æœªæŒ‡å®šæ™‚ã®å…¨ä»¶å‰Šé™¤ãƒ­ã‚¸ãƒƒã‚¯
- [ ] ã‚µãƒ¼ãƒãƒ¼å…¨ãƒãƒ£ãƒ³ãƒãƒ«å–å¾—ï¼ˆBot ã‚¢ã‚¯ã‚»ã‚¹ä¸å¯ãƒãƒ£ãƒ³ãƒãƒ«ã®ã‚¹ã‚­ãƒƒãƒ—ï¼‰
- [ ] `days` æŒ‡å®šã«ã‚ˆã‚‹æœŸé–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆafterTs/beforeTs ã®è¨ˆç®—ï¼‰
- [ ] `after` / `before` ã®æ—¥ä»˜ãƒ‘ãƒ¼ã‚¹ã¨ boundary è¨ˆç®—ï¼ˆæ™‚åˆ»çœç•¥è£œå®Œï¼‰
- [ ] `days` + `after`/`before` åŒæ™‚æŒ‡å®šã®æ’ä»–ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- [ ] ç„¡åŠ¹ãªæ—¥ä»˜å½¢å¼ã®ã‚¨ãƒ©ãƒ¼
- [ ] `after` > `before` ã®ã‚¨ãƒ©ãƒ¼
- [ ] ãƒ•ã‚§ãƒƒãƒæ‰“ã¡åˆ‡ã‚Šæœ€é©åŒ–ï¼ˆãƒãƒƒãƒæœ€å¤ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒ afterTs ã‚ˆã‚Šå‰ã®å ´åˆï¼‰
- [ ] `showConfirmDialog` â€” ã€Œâœ… å‰Šé™¤ã™ã‚‹ã€æŠ¼ä¸‹ã§ `"confirmed"` ã‚’è¿”ã™
- [ ] `showConfirmDialog` â€” ã€ŒâŒ ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€æŠ¼ä¸‹ã§ `"cancelled"` ã‚’è¿”ã™
- [ ] `showConfirmDialog` â€” 60ç§’ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã§ `"timeout"` ã‚’è¿”ã™
- [ ] `showConfirmDialog` â€” ã€Œæ¬¡å›ã‹ã‚‰ç¢ºèªã—ãªã„ã€ãƒˆã‚°ãƒ«ã§ `skipNext` ãŒå¤‰åŒ–ã™ã‚‹
- [ ] `showConfirmDialog` â€” ã€Œæ¬¡å›ã‹ã‚‰ç¢ºèªã—ãªã„ã€ON + ã€Œâœ… å‰Šé™¤ã™ã‚‹ã€æŠ¼ä¸‹ã§ `saveUserSetting` ãŒå‘¼ã°ã‚Œã‚‹
- [ ] `showConfirmDialog` â€” `skipNext = false` ã§ã€Œâœ… å‰Šé™¤ã™ã‚‹ã€æŠ¼ä¸‹ã®å ´åˆã€`saveUserSetting` ãŒå‘¼ã°ã‚Œãªã„
- [ ] `getUserSetting` â€” DB æœªç™»éŒ²æ™‚ã« `{ skipConfirm: false }` ã‚’è¿”ã™
- [ ] `getUserSetting` / `saveUserSetting` ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼Ã—ã‚®ãƒ«ãƒ‰ã”ã¨ã®ç‹¬ç«‹æ€§

### ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ

- [ ] é€šå¸¸å‰Šé™¤ï¼ˆ14æ—¥ä»¥å†…ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰
- [ ] 14æ—¥ä»¥ä¸Šå‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å€‹åˆ¥å‰Šé™¤
- [ ] æ··åœ¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆ14æ—¥ä»¥å†… + 14æ—¥ä»¥é™ï¼‰ã®å‰Šé™¤
- [ ] ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŒ‡å®šå‰Šé™¤ï¼ˆã‚µãƒ¼ãƒãƒ¼å…¨ä½“ï¼‰
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼æŒ‡å®šå‰Šé™¤ï¼ˆã‚µãƒ¼ãƒãƒ¼å…¨ä½“ï¼‰
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ + ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ + channel æŒ‡å®šå‰Šé™¤
- [ ] days æŒ‡å®šå‰Šé™¤ï¼ˆå…¨ãƒãƒ£ãƒ³ãƒãƒ«æ¨ªæ–­ï¼‰
- [ ] after + before ã®ç¯„å›²æŒ‡å®šå‰Šé™¤
- [ ] after ã®ã¿æŒ‡å®šå‰Šé™¤
- [ ] before ã®ã¿æŒ‡å®šå‰Šé™¤
- [ ] count + days ã®çµ„ã¿åˆã‚ã›ï¼ˆæœŸé–“å†…ã§ä»¶æ•°ä¸Šé™ï¼‰
- [ ] channel æœªæŒ‡å®šã§ã‚µãƒ¼ãƒãƒ¼å…¨ãƒãƒ£ãƒ³ãƒãƒ«ã‚’æ¨ªæ–­ã—ã¦å‰Šé™¤
- [ ] count åˆè¨ˆãŒå…¨ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ã¾ãŸã„ã§æ­£ã—ãæ©Ÿèƒ½ã™ã‚‹ã“ã¨
- [ ] ã™ã¹ã¦ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚ªãƒ—ã‚·ãƒ§ãƒ³æœªæŒ‡å®šæ™‚ã®ã‚¨ãƒ©ãƒ¼å‡¦ç†
- [ ] days ã¨ after ã®åŒæ™‚æŒ‡å®šã‚¨ãƒ©ãƒ¼
- [ ] after > before ã‚¨ãƒ©ãƒ¼
- [ ] ç„¡åŠ¹ãªæ—¥ä»˜å½¢å¼ã‚¨ãƒ©ãƒ¼ï¼ˆafter/beforeï¼‰
- [ ] afterTs æœ€é©åŒ–ã«ã‚ˆã‚‹ãƒ•ã‚§ãƒƒãƒæ‰“ã¡åˆ‡ã‚Šã®å‹•ä½œç¢ºèª
- [ ] æ¨©é™ä¸è¶³ã‚¨ãƒ©ãƒ¼
- [ ] Cooldown æ©Ÿèƒ½
- [ ] åŒæ™‚å®Ÿè¡Œæ™‚ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‰Šé™¤ç«¶åˆï¼‰
- [ ] å¤§é‡å‰Šé™¤æ™‚ã®é€²æ—è¡¨ç¤º
- [ ] `skipConfirm = false` ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ `/message-delete` ã‚’å®Ÿè¡Œã—ãŸã¨ãç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ã€Œâœ… å‰Šé™¤ã™ã‚‹ã€æŠ¼ä¸‹å¾Œã«å‰Šé™¤ãŒå®Ÿè¡Œã•ã‚Œã‚‹
- [ ] ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ã€ŒâŒ ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€æŠ¼ä¸‹å¾Œã«å‰Šé™¤ãŒå®Ÿè¡Œã•ã‚Œãªã„
- [ ] ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ã€Œæ¬¡å›ã‹ã‚‰ç¢ºèªã—ãªã„ã€ON +ã€Œâœ… å‰Šé™¤ã™ã‚‹ã€å¾Œã€æ¬¡å›å®Ÿè¡Œã§ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒå‡ºãªã„
- [ ] `skipConfirm = true` ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒ `/message-delete` ã‚’å®Ÿè¡Œã—ãŸã¨ãç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹
- [ ] `/message-delete-config confirm:false` å®Ÿè¡Œå¾Œã€æ¬¡å›ã® `/message-delete` ã§ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒå‡ºãªã„
- [ ] `/message-delete-config confirm:true` å®Ÿè¡Œå¾Œã€æ¬¡å›ã® `/message-delete` ã§ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒå¾©æ´»ã™ã‚‹
- [ ] `/message-delete-config` ã®è¨­å®šã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼Ã—ã‚®ãƒ«ãƒ‰ã”ã¨ã«ç‹¬ç«‹ã—ã¦ã„ã‚‹

### ãƒšãƒ¼ã‚¸ãƒã‚¤ã‚·ãƒ§ãƒ³ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ†ã‚¹ãƒˆ

- [ ] 5ä»¶ã”ã¨ã«ãƒšãƒ¼ã‚¸ãŒåŒºåˆ‡ã‚‰ã‚Œã‚‹ã“ã¨
- [ ] 1ä»¶ã®ã¿ã®å ´åˆã¯ãƒšãƒ¼ã‚¸ãƒã‚¤ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ãŒè¡¨ç¤ºã•ã‚Œãªã„ã“ã¨
- [ ] ãƒšãƒ¼ã‚¸ãƒã‚¤ã‚·ãƒ§ãƒ³ã€Œå‰ã¸ã€ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã®å‹•ä½œ
- [ ] 1ãƒšãƒ¼ã‚¸ç›®ã§ã€Œå‰ã¸ã€ãŒç„¡åŠ¹åŒ–ã•ã‚Œã‚‹ã“ã¨
- [ ] æœ€çµ‚ãƒšãƒ¼ã‚¸ã§ã€Œæ¬¡ã¸ã€ãŒç„¡åŠ¹åŒ–ã•ã‚Œã‚‹ã“ã¨
- [ ] æŠ•ç¨¿è€…ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã§æ­£ã—ãçµã‚Šè¾¼ã¾ã‚Œã‚‹ã“ã¨
- [ ] ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã§æ­£ã—ãçµã‚Šè¾¼ã¾ã‚Œã‚‹ã“ã¨
- [ ] éå»Næ—¥é–“ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆä»»æ„ã®æ•°å€¤ã‚’å…¥åŠ›ã—ã€Næ—¥ä»¥å†…ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿è¡¨ç¤ºï¼‰
- [ ] éå»Næ—¥é–“ã« 1 æœªæº€ã¾ãŸã¯æ•´æ•°ä»¥å¤–ã‚’å…¥åŠ›ã—ãŸæ™‚ã®ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
- [ ] éå»Næ—¥é–“å…¥åŠ›æ™‚ã€after/before ãƒœã‚¿ãƒ³ã®ç„¡åŠ¹åŒ–
- [ ] after/before å…¥åŠ›æ™‚ã€éå»Næ—¥é–“ãƒœã‚¿ãƒ³ã®ç„¡åŠ¹åŒ–
- [ ] after ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆæŒ‡å®šæ—¥æ™‚ä»¥é™ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿è¡¨ç¤ºï¼‰
- [ ] before ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆæŒ‡å®šæ—¥æ™‚ä»¥å‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿è¡¨ç¤ºï¼‰
- [ ] after + before ä¸¡æ–¹æŒ‡å®šã® AND ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
- [ ] after/before æŒ‡å®šæ™‚ã€éå»Næ—¥é–“ãƒœã‚¿ãƒ³ãŒç„¡åŠ¹åŒ–ã•ã‚Œã‚‹ã“ã¨
- [ ] after/before æŒ‡å®šæ™‚ã€Embed footer ã« after/before æ—¥ä»˜ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨
- [ ] after/before ã«ç„¡åŠ¹ãªæ—¥ä»˜å…¥åŠ›æ™‚ã®ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¯é©ç”¨ã•ã‚Œãªã„ï¼‰
- [ ] after > before å…¥åŠ›æ™‚ã®ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¯é©ç”¨ã•ã‚Œãªã„ï¼‰
- [ ] after/before ãƒªã‚»ãƒƒãƒˆå¾Œã€éå»Næ—¥é–“ãƒœã‚¿ãƒ³ãŒå†æœ‰åŠ¹åŒ–ã•ã‚Œã‚‹ã“ã¨
- [ ] è¤‡æ•°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã® AND æ¡ä»¶ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ã“ã¨
- [ ] ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒªã‚»ãƒƒãƒˆã§å…¨ä»¶è¡¨ç¤ºã«æˆ»ã‚‹ã“ã¨
- [ ] 15åˆ†å¾Œã«ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã€ãƒœã‚¿ãƒ³ãŒç„¡åŠ¹åŒ–ã•ã‚Œã‚‹ã“ã¨
- [ ] ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œè€…ä»¥å¤–ãŒãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸå ´åˆã«å¼¾ã‹ã‚Œã‚‹ã“ã¨

---

## ğŸŒ å¤šè¨€èªå¯¾å¿œï¼ˆi18nextï¼‰

### ãƒ­ãƒ¼ã‚«ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ã‚­ãƒ¼

```typescript
// commands.json
export default {
  msgDel: {
    errors: {
      filterOptionsEmpty: {
        title: "è­¦å‘Š",
        description:
          "ãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„ãŸã‚å®Ÿè¡Œã§ãã¾ã›ã‚“ã€‚\n" +
          "`count`ãƒ»`user`ãƒ»`keyword`ãƒ»`days`ãƒ»`after`ãƒ»`before` ã®ã„ãšã‚Œã‹1ã¤ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚",
      },
      invalidChannel: "ãƒ†ã‚­ã‚¹ãƒˆãƒãƒ£ãƒ³ãƒãƒ«ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚",
      noMessages: "å‰Šé™¤å¯èƒ½ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚",
      permissionDenied: "ã“ã®æ“ä½œã‚’å®Ÿè¡Œã™ã‚‹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚",
      botPermissionDenied: "Botã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‰Šé™¤æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“ã€‚",
      failed: "ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å‰Šé™¤ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚",
      sessionExpired:
        "ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒæœŸé™åˆ‡ã‚Œã§ã™ã€‚ã‚³ãƒãƒ³ãƒ‰ã‚’å†å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚",
      daysAndDateConflict:
        "`days` ã¨ `after`/`before` ã¯åŒæ™‚ã«æŒ‡å®šã§ãã¾ã›ã‚“ã€‚ã©ã¡ã‚‰ã‹ä¸€æ–¹ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚",
      invalidAfterDate:
        "`after` ã®æ—¥ä»˜å½¢å¼ãŒä¸æ­£ã§ã™ã€‚`YYYY-MM-DD` ã¾ãŸã¯ `YYYY-MM-DDTHH:MM:SS` å½¢å¼ã§æŒ‡å®šã—ã¦ãã ã•ã„ã€‚",
      invalidBeforeDate:
        "`before` ã®æ—¥ä»˜å½¢å¼ãŒä¸æ­£ã§ã™ã€‚`YYYY-MM-DD` ã¾ãŸã¯ `YYYY-MM-DDTHH:MM:SS` å½¢å¼ã§æŒ‡å®šã—ã¦ãã ã•ã„ã€‚",
      afterAfterBefore: "`after` ã¯ `before` ã‚ˆã‚Šå‰ã®æ—¥æ™‚ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚",
    },
    confirm: {
      title: "âš ï¸ **ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“**",
      body: "ä»¥ä¸‹ã®æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‰Šé™¤ã—ã¾ã™ã€‚å®Ÿè¡Œã—ã¾ã™ã‹ï¼Ÿ",
      yes: "âœ… å‰Šé™¤ã™ã‚‹",
      no: "âŒ ã‚­ãƒ£ãƒ³ã‚»ãƒ«",
      skipToggleOff: "[ ] æ¬¡å›ã‹ã‚‰ç¢ºèªã—ãªã„",
      skipToggleOn: "[âœ“] æ¬¡å›ã‹ã‚‰ç¢ºèªã—ãªã„",
      cancelled: "âŒ å‰Šé™¤ã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¾ã—ãŸã€‚",
      timeout: "âŒ› ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸã€‚å†åº¦ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚",
    },
    progress: {
      collecting: "å‰Šé™¤ä¸­... ({{channel}}) åé›†: {{count}}ä»¶",
      deleting: "å‰Šé™¤ä¸­... {{current}}/{{total}}ä»¶",
      bulk: "å‰Šé™¤ä¸­... {{current}}/{{total}}ä»¶ (ä¸€æ‹¬å‰Šé™¤)",
      individual:
        "å‰Šé™¤ä¸­... {{current}}/{{total}}ä»¶ (14æ—¥ä»¥ä¸Šå‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å€‹åˆ¥å‰Šé™¤ä¸­...)",
    },
    success: {
      title: "âœ… å‰Šé™¤å®Œäº†",
      totalCount: "åˆè¨ˆå‰Šé™¤ä»¶æ•°",
      channelBreakdown: "ãƒãƒ£ãƒ³ãƒãƒ«åˆ¥å†…è¨³",
      listTitle: "ğŸ“‹ å‰Šé™¤ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§  ({{page}} / {{total}} ãƒšãƒ¼ã‚¸)",
      listTitleFiltered:
        "ğŸ“‹ å‰Šé™¤ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§  ({{page}} / {{total}} ãƒšãƒ¼ã‚¸) ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨ä¸­ï¼‰",
    },
    pagination: {
      prev: "â—€ å‰ã¸",
      next: "â–¶ æ¬¡ã¸",
      filterByAuthor: "æŠ•ç¨¿è€…ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼",
      filterByKeyword: "å†…å®¹ã§æ¤œç´¢ ğŸ”",
      filterByDays: "éå»Næ—¥é–“ã‚’å…¥åŠ› ğŸ”¢",
      filterByDaysActive: "éå»{{days}}æ—¥é–“ âœï¸",
      filterByAfter: "afterï¼ˆé–‹å§‹æ—¥æ™‚ï¼‰ã‚’å…¥åŠ› ğŸ“…",
      filterByBefore: "beforeï¼ˆçµ‚äº†æ—¥æ™‚ï¼‰ã‚’å…¥åŠ› ğŸ“…",
      filterByAfterActive: "after: {{date}} âœï¸",
      filterByBeforeActive: "before: {{date}} âœï¸",
      resetFilter: "ãƒªã‚»ãƒƒãƒˆ âœ•",
      invalidDaysInput: "æ—¥æ•°ã¯1ä»¥ä¸Šã®æ•´æ•°ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚",
    },
  },
  msgDelConfig: {
    success:
      "âœ… è¨­å®šã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚æ¬¡å›ã® `/message-delete` ã‹ã‚‰åæ˜ ã•ã‚Œã¾ã™ã€‚",
    confirmEnabled: "å®Ÿè¡Œç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°: æœ‰åŠ¹",
    confirmDisabled: "å®Ÿè¡Œç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°: ç„¡åŠ¹",
  },
};
```

---

## é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [Discord.js - TextChannel.bulkDelete](https://discord.js.org/#/docs/discord.js/main/class/TextChannel?scrollTo=bulkDelete)
- [Discord.js - Message.fetch](https://discord.js.org/#/docs/discord.js/main/class/MessageManager?scrollTo=fetch)
- [Discord API - Bulk Delete Messages](https://discord.com/developers/docs/resources/channel#bulk-delete-messages)
